(function(){"use strict";var e={2462:function(e,t,s){var a=s(5130),r=s(6768);const l={id:"app"},o={class:"container py-4"};function n(e,t,s,a,n,i){const c=(0,r.g2)("Navbar"),d=(0,r.g2)("router-view"),u=(0,r.g2)("AppFooter");return(0,r.uX)(),(0,r.CE)("div",l,[a.isAuthenticated?((0,r.uX)(),(0,r.Wv)(c,{key:0})):(0,r.Q3)("",!0),(0,r.Lk)("main",o,[(0,r.bF)(d)]),(0,r.bF)(u)])}var i=s(782),c=s(4232);const d={class:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},u={class:"container"},m={class:"navbar-nav me-auto mb-2 mb-lg-0"},p={class:"nav-item"},f={class:"nav-item"},v={key:0,class:"nav-item"},g={class:"d-flex"},k={key:0},b={key:1,class:"custom-dropdown"};function h(e,t,s,l,o,n){const i=(0,r.g2)("router-link"),h=(0,r.gN)("click-outside");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("nav",d,[(0,r.Lk)("div",u,[(0,r.bF)(i,{class:"navbar-brand",to:"/"},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.Lk)("i",{class:"fas fa-share-alt me-2"},null,-1),(0,r.eW)(" SocialConnect ")]))),_:1}),(0,r.Lk)("button",{class:"navbar-toggler",type:"button",onClick:t[0]||(t[0]=(...e)=>l.toggleNavbar&&l.toggleNavbar(...e))},t[6]||(t[6]=[(0,r.Lk)("span",{class:"navbar-toggler-icon"},null,-1)])),(0,r.Lk)("div",{class:(0,c.C4)(["collapse navbar-collapse",{show:l.navbarOpen}])},[(0,r.Lk)("ul",m,[(0,r.Lk)("li",p,[(0,r.bF)(i,{class:"nav-link",to:"/",exact:""},{default:(0,r.k6)((()=>t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-home me-1"},null,-1),(0,r.eW)(" Home ")]))),_:1})]),(0,r.Lk)("li",f,[(0,r.bF)(i,{class:"nav-link",to:"/reels"},{default:(0,r.k6)((()=>t[8]||(t[8]=[(0,r.Lk)("i",{class:"fas fa-film me-1"},null,-1),(0,r.eW)(" Reels ")]))),_:1})]),l.isAuthenticated?((0,r.uX)(),(0,r.CE)("li",v,[(0,r.bF)(i,{class:"nav-link",to:`/profile/${l.currentUser.username}`},{default:(0,r.k6)((()=>t[9]||(t[9]=[(0,r.Lk)("i",{class:"fas fa-user me-1"},null,-1),(0,r.eW)(" Profile ")]))),_:1},8,["to"])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",g,[(0,r.Lk)("form",{class:"d-flex me-2",onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>l.handleSearch&&l.handleSearch(...e)),["prevent"]))},[(0,r.bo)((0,r.Lk)("input",{class:"form-control me-2",type:"search",placeholder:"Search","onUpdate:modelValue":t[1]||(t[1]=e=>l.searchQuery=e),"aria-label":"Search"},null,512),[[a.Jo,l.searchQuery]]),t[10]||(t[10]=(0,r.Lk)("button",{class:"btn btn-outline-primary",type:"submit"},[(0,r.Lk)("i",{class:"fas fa-search"})],-1))],32),l.isAuthenticated?(0,r.bo)(((0,r.uX)(),(0,r.CE)("div",b,[(0,r.Lk)("button",{class:"btn btn-outline-secondary dropdown-toggle",type:"button",onClick:t[3]||(t[3]=(...e)=>l.toggleDropdown&&l.toggleDropdown(...e))},[t[13]||(t[13]=(0,r.Lk)("i",{class:"fas fa-user-circle me-1"},null,-1)),(0,r.eW)(" "+(0,c.v_)(l.currentUser.username),1)]),(0,r.Lk)("ul",{class:(0,c.C4)(["dropdown-menu dropdown-menu-end",{show:l.dropdownOpen}])},[(0,r.Lk)("li",null,[(0,r.bF)(i,{class:"dropdown-item",to:`/profile/${l.currentUser.username}`},{default:(0,r.k6)((()=>t[14]||(t[14]=[(0,r.Lk)("i",{class:"fas fa-user me-2"},null,-1),(0,r.eW)(" My Profile ")]))),_:1},8,["to"])]),(0,r.Lk)("li",null,[(0,r.bF)(i,{class:"dropdown-item",to:"/create-post"},{default:(0,r.k6)((()=>t[15]||(t[15]=[(0,r.Lk)("i",{class:"fas fa-edit me-2"},null,-1),(0,r.eW)(" Create Post ")]))),_:1})]),(0,r.Lk)("li",null,[(0,r.bF)(i,{class:"dropdown-item",to:"/create-reel"},{default:(0,r.k6)((()=>t[16]||(t[16]=[(0,r.Lk)("i",{class:"fas fa-film me-2"},null,-1),(0,r.eW)(" Create Reel ")]))),_:1})]),t[18]||(t[18]=(0,r.Lk)("li",null,[(0,r.Lk)("hr",{class:"dropdown-divider"})],-1)),(0,r.Lk)("li",null,[(0,r.Lk)("button",{class:"dropdown-item text-danger",onClick:t[4]||(t[4]=(...e)=>l.logout&&l.logout(...e))},t[17]||(t[17]=[(0,r.Lk)("i",{class:"fas fa-sign-out-alt me-2"},null,-1),(0,r.eW)(" Logout ")]))])],2)])),[[h,l.closeDropdown]]):((0,r.uX)(),(0,r.CE)("div",k,[(0,r.bF)(i,{to:"/login",class:"btn btn-outline-primary me-2"},{default:(0,r.k6)((()=>t[11]||(t[11]=[(0,r.eW)("Login")]))),_:1}),(0,r.bF)(i,{to:"/register",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[12]||(t[12]=[(0,r.eW)("Register")]))),_:1})]))])],2)])]),t[19]||(t[19]=(0,r.Lk)("div",{style:{height:"60px"}},null,-1))],64)}s(4114);var y=s(144),L=s(1387),w={name:"NavBar",setup(){const e=(0,i.Pj)(),t=(0,L.rd)(),s=(0,y.KR)(""),a=(0,y.KR)(!1),l=(0,y.KR)(!1),o=(0,r.EW)((()=>e.getters["auth/isAuthenticated"])),n=(0,r.EW)((()=>e.getters["auth/currentUser"])),c=()=>{a.value=!a.value},d=()=>{a.value=!1},u=()=>{l.value=!l.value},m=()=>{d(),e.dispatch("auth/logout")},p=()=>{s.value.trim()&&(t.push({path:"/search",query:{q:s.value.trim(),tab:"users"}}),s.value="")};return{searchQuery:s,isAuthenticated:o,currentUser:n,dropdownOpen:a,navbarOpen:l,toggleDropdown:c,closeDropdown:d,toggleNavbar:u,logout:m,handleSearch:p}},directives:{"click-outside":{mounted(e,t){e.clickOutsideEvent=s=>{e===s.target||e.contains(s.target)||t.value(s)},document.addEventListener("click",e.clickOutsideEvent)},unmounted(e){document.removeEventListener("click",e.clickOutsideEvent)}}}},_=s(1241);const C=(0,_.A)(w,[["render",h],["__scopeId","data-v-3a6d09d4"]]);var E=C;const P={class:"bg-light text-center py-3 mt-auto"},R={class:"container"},F={class:"mb-0"};function U(e,t,s,a,l,o){return(0,r.uX)(),(0,r.CE)("footer",P,[(0,r.Lk)("div",R,[(0,r.Lk)("p",F,"Â© "+(0,c.v_)(l.currentYear)+" SocialApp. All rights reserved.",1)])])}var x={data(){return{currentYear:(new Date).getFullYear()}}};const I=(0,_.A)(x,[["render",U]]);var W=I,X={name:"App",components:{Navbar:E,AppFooter:W},setup(){const e=(0,i.Pj)(),t=(0,r.EW)((()=>e.getters["auth/isAuthenticated"]));return(0,r.sV)((async()=>{if(e.dispatch("users/fixProfilePicturePaths"),t.value){const t=await e.dispatch("auth/fetchCurrentUser");if(t&&t.profile_picture&&t.profile_picture.includes("/static/profile_pictures/static/profile_pictures/")){const s={...t,profile_picture:t.profile_picture.replace("/static/profile_pictures/static/profile_pictures/","/static/profile_pictures/")};e.commit("auth/set_user",s),localStorage.setItem("user",JSON.stringify(s))}}})),{isAuthenticated:t}}};const D=(0,_.A)(X,[["render",n]]);var A=D,S=(s(8111),s(3579),s(4373));const $=S.A.create({baseURL:"https://social-media-platform-jgf2.onrender.com",timeout:3e4,headers:{Accept:"application/json"}});$.interceptors.response.use((e=>((e.config.url.includes("profile-picture")||e.data&&e.data.profile_picture)&&console.log("API Response with profile picture:",{url:e.config.url,method:e.config.method,profilePicture:e.data.profile_picture}),e)),(e=>Promise.reject(e))),$.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers["Authorization"]=`Bearer ${t}`),e.headers["Content-Type"]||e.data instanceof FormData||(e.headers["Content-Type"]="application/json"),console.log("API Request:",{url:e.url,method:e.method,headers:{...e.headers,Authorization:e.headers.Authorization?"**TOKEN**":void 0},data:e.data instanceof FormData?"FormData":e.data}),e}),(e=>(console.error("API Request Error:",e),Promise.reject(e)))),$.interceptors.response.use((e=>(console.log("API Response Success:",{url:e.config.url,status:e.status}),e)),(e=>{if(console.error("API Error:",{message:e.message,code:e.code,response:e.response?{status:e.response.status,data:e.response.data}:"No response",config:e.config?{url:e.config.url,method:e.config.method,headers:e.config.headers?{...e.config.headers,Authorization:e.config.headers.Authorization?"**TOKEN**":void 0}:"No headers"}:"No config"}),"ERR_NETWORK"===e.code&&console.error("Network Error: Unable to connect to the server"),e.response)switch(e.response.status){case 401:localStorage.removeItem("token"),xi.push("/login");break;case 403:console.error("Access Forbidden");break;case 404:console.error("Resource Not Found");break;case 500:console.error("Internal Server Error");break}return Promise.reject(e)}));const K=async()=>{try{console.log("Testing API connection to:",$.defaults.baseURL);const e=await $.get("/");return console.log("API connection successful:",e.status),!0}catch(e){return console.error("API connection test failed:",e.message),"ERR_NETWORK"===e.code&&console.error("Network error details:",{baseURL:$.defaults.baseURL,message:"Unable to connect to the API server. Possible causes:",causes:["1. Backend server is not running","2. CORS is not configured on the backend","3. Backend URL is incorrect","4. Network/firewall is blocking the connection"],suggestions:["- Check that your backend server is running","- Ensure CORS is properly configured","- Verify the API URL is correct","- Try accessing the API URL directly in your browser"]}),!1}};$.testConnection=K;var V=$,T={login(e,t){const s=new URLSearchParams;return s.append("username",e),s.append("password",t),console.log("Login Request Details:",{url:"/users/login",method:"POST",data:{username:e}}),V.post("/users/login",s.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).catch((e=>{throw console.error("Detailed Login Error:",{message:e.message,code:e.code,response:e.response,request:e.request,config:e.config}),e}))},register(e){return V.post("/users/",e)},getCurrentUser(){return V.get("/users/me")}};const q={token:localStorage.getItem("token")||"",user:JSON.parse(localStorage.getItem("user"))||null,status:""},B={isAuthenticated:e=>!!e.token,authStatus:e=>e.status,currentUser:e=>e.user},Q={async login({commit:e,dispatch:t},{username:s,password:a}){e("auth_request");try{console.log("Login action started with username:",s);const l=await T.login(s,a);console.log("Login response received:",l.data);const o=l.data.access_token;if(!o)return console.error("No token in response:",l.data),e("auth_error"),!1;localStorage.setItem("token",o),e("auth_success",o);try{const e=await t("fetchCurrentUser");return!!e}catch(r){return console.error("Error fetching user profile:",r),!0}}catch(l){return console.error("Login error:",l.response?l.response.data:l),e("auth_error"),localStorage.removeItem("token"),!1}},async fetchCurrentUser({commit:e}){try{const t=await T.getCurrentUser(),s=t.data;return localStorage.setItem("user",JSON.stringify(s)),e("set_user",s),s}catch(t){return console.error("Failed to fetch user profile:",t),e("auth_error"),null}},async register({commit:e,dispatch:t},s){e("auth_request");try{return await T.register(s),t("login",{username:s.username,password:s.password})}catch(a){return e("auth_error"),!1}},logout({commit:e}){localStorage.removeItem("token"),localStorage.removeItem("user"),e("logout"),xi.push("/login")}},j={auth_request(e){e.status="loading"},auth_success(e,t){e.status="success",e.token=t},auth_error(e){e.status="error",e.token=""},set_user(e,t){e.user=t},logout(e){e.status="",e.token="",e.user=null}};var O={namespaced:!0,state:q,getters:B,actions:Q,mutations:j},N=(s(2489),s(116),{getPosts(e=10,t=0,s=""){return V.get(`/posts/?limit=${e}&skip=${t}&search=${s}`)},getPostById(e){return V.get(`/posts/${e}`)},getLatestPost(){return V.get("/posts/latest")},createPost(e){return V.post("/posts/",e)},updatePost(e,t){return V.put(`/posts/${e}`,t)},deletePost(e){return V.delete(`/posts/${e}`)},votePost(e){return V.post("/vote/",{post_id:e})}});const M={posts:[],currentPost:null,loading:!1,error:null},z={allPosts:e=>e.posts,getPostById:e=>t=>e.posts.find((e=>e.id===t)),getCurrentPost:e=>e.currentPost},J={async fetchPosts({commit:e},{limit:t,skip:s,search:a}){e("set_loading",!0);try{const r=await N.getPosts(t,s,a);e("set_posts",r.data)}catch(r){e("set_error",r.message)}finally{e("set_loading",!1)}},async fetchPostById({commit:e},t){e("set_loading",!0);try{const s=await N.getPostById(t);return e("set_current_post",s.data),s.data}catch(s){return e("set_error",s.message),null}finally{e("set_loading",!1)}},async createPost({commit:e},t){e("set_loading",!0);try{const s=await N.createPost(t);return e("add_post",s.data),s.data}catch(s){return e("set_error",s.message),null}finally{e("set_loading",!1)}},async updatePost({commit:e},{id:t,postData:s}){e("set_loading",!0);try{const a=await N.updatePost(t,s);return e("update_post",a.data),M.currentPost&&M.currentPost.id===t&&e("set_current_post",a.data),a.data}catch(a){return e("set_error",a.message),null}finally{e("set_loading",!1)}},async deletePost({commit:e},t){e("set_loading",!0);try{return await N.deletePost(t),e("remove_post",t),!0}catch(s){return e("set_error",s.message),!1}finally{e("set_loading",!1)}},async votePost({commit:e},t){try{return await N.votePost(t),e("toggle_vote",t),!0}catch(s){return e("set_error",s.message),!1}}},G={set_loading(e,t){e.loading=t},set_error(e,t){e.error=t},set_posts(e,t){e.posts=t},add_post(e,t){e.posts.unshift(t)},set_current_post(e,t){e.currentPost=t},update_post(e,t){const s=e.posts.findIndex((e=>e.id===t.id));-1!==s&&e.posts.splice(s,1,t)},remove_post(e,t){e.posts=e.posts.filter((e=>e.id!==t)),e.currentPost&&e.currentPost.id===t&&(e.currentPost=null)},toggle_vote(e,t){const s=e.posts.find((e=>e.id===t));s&&(s.votes=s.hasVoted?s.votes-1:s.votes+1,s.hasVoted=!s.hasVoted),e.currentPost&&e.currentPost.id===t&&(e.currentPost.votes=e.currentPost.hasVoted?e.currentPost.votes-1:e.currentPost.votes+1,e.currentPost.hasVoted=!e.currentPost.hasVoted)}};var H={namespaced:!0,state:M,getters:z,actions:J,mutations:G},Y={getComments(e){return V.get(`/posts/${e}/comments`)},createComment(e,t){return V.post(`/posts/${e}/comment`,{content:t})}};const Z={comments:{},loading:!1,error:null},ee={getCommentsByPostId:e=>t=>e.comments[t]||[]},te={async fetchComments({commit:e},t){e("set_loading",!0);try{const s=await Y.getComments(t);return e("set_comments",{postId:t,comments:s.data}),s.data}catch(s){return e("set_error",s.message),[]}finally{e("set_loading",!1)}},async createComment({commit:e,dispatch:t},{postId:s,content:a}){e("set_loading",!0);try{const e=await Y.createComment(s,a);return await t("fetchComments",s),e.data}catch(r){return e("set_error",r.message),null}finally{e("set_loading",!1)}}},se={set_loading(e,t){e.loading=t},set_error(e,t){e.error=t},set_comments(e,{postId:t,comments:s}){e.comments={...e.comments,[t]:s}},add_comment(e,{postId:t,comment:s}){e.comments[t]||(e.comments[t]=[]),e.comments[t].push(s)}};var ae={namespaced:!0,state:Z,getters:ee,actions:te,mutations:se};s(7588),s(1701);function re(e){return e?e.includes("static/profile_pictures")?(e=e.replace(/static\/profile_pictures\/static\/profile_pictures/g,"static/profile_pictures"),e.startsWith("/")||(e="/"+e),e):`/static/profile_pictures/${e}`:""}var le={getUsers(){return V.get("/users/")},getUserById(e){return V.get(`/users/id/${e}`)},getUserByUsername(e){return V.get(`/users/username/${e}`)},updateUser(e,t){return V.put(`/users/${e}`,t)},deleteUser(e){return V.delete(`/users/${e}`)},searchUsers(e){return V.get(`/users/search?q=${encodeURIComponent(e)}`)},updateUserProfile(e){return V.put("/users/me",e)},uploadProfilePicture(e){const t=new FormData;return t.append("file",e),V.post("/users/upload-profile-picture",t,{headers:{"Content-Type":"multipart/form-data"},transformResponse:[e=>{try{const t=JSON.parse(e);return t&&t.profile_picture&&(t.profile_picture=re(t.profile_picture)),t}catch(t){return console.error("Error parsing profile picture response:",t),e}}]})},uploadBackgroundImage(e){const t=new FormData;return t.append("file",e),V.post("/users/upload-background-image",t,{headers:{"Content-Type":"multipart/form-data"}})}},oe={followUser(e){return V.post(`/users/follow/${e}`)},unfollowUser(e){return V.post(`/users/unfollow/${e}`)},getFollowers(){return V.get("/users/followers")},getFollowing(){return V.get("/users/following")}};function ne(e){return e?(e=e.replace(/static\/profile_pictures\/static\/profile_pictures/g,"static/profile_pictures"),e=e.replace(/\/static\/profile_pictures\/static\/profile_pictures/g,"/static/profile_pictures"),e.includes("static/profile_pictures")&&!e.startsWith("/")&&(e="/"+e),e):""}function ie(e){return e&&e.profile_picture?{...e,profile_picture:ne(e.profile_picture)}:e}const ce={users:[],userProfiles:{},followers:[],following:[],loading:!1,error:null,searchResults:[],searchLoading:!1,searchError:null},de={allUsers:e=>e.users,getUserById:e=>t=>e.userProfiles[t],followers:e=>e.followers,following:e=>e.following,searchResults:e=>e.searchResults,searchLoading:e=>e.searchLoading,searchError:e=>e.searchError},ue={async fetchUsers({commit:e}){e("set_loading",!0);try{const t=await le.getUsers(),s=t.data.map((e=>ie(e)));return e("set_users",s),s}catch(t){return e("set_error",t.message),[]}finally{e("set_loading",!1)}},async fetchUserById({commit:e},t){e("set_loading",!0);try{const s=await le.getUserById(t),a=ie(s.data);return e("set_user_profile",a),a}catch(s){return e("set_error",s.message),null}finally{e("set_loading",!1)}},async fetchUserByUsername({commit:e},t){e("set_loading",!0);try{const s=await le.getUserByUsername(t),a=ie(s.data);return e("set_user_profile",a),a}catch(s){return e("set_error",s.message),null}finally{e("set_loading",!1)}},async searchUsers({commit:e},t){e("set_search_loading",!0),e("set_search_error",null);try{const s=await le.searchUsers(t);return e("set_search_results",s.data),s.data}catch(s){return e("set_search_error",s.message),[]}finally{e("set_search_loading",!1)}},async fetchFollowers({commit:e}){e("set_loading",!0);try{const t=await oe.getFollowers(),s=t.data.map((e=>ie(e)));return e("set_followers",s),s}catch(t){return e("set_error",t.message),[]}finally{e("set_loading",!1)}},async fetchFollowing({commit:e}){e("set_loading",!0);try{const t=await oe.getFollowing(),s=t.data.map((e=>ie(e)));return e("set_following",s),s}catch(t){return e("set_error",t.message),[]}finally{e("set_loading",!1)}},async followUser({commit:e,dispatch:t},s){try{return await oe.followUser(s),await t("fetchFollowing"),!0}catch(a){return e("set_error",a.message),!1}},async unfollowUser({commit:e,dispatch:t},s){try{return await oe.unfollowUser(s),await t("fetchFollowing"),!0}catch(a){return e("set_error",a.message),!1}},async updateUser({commit:e},t){e("set_loading",!0);try{const s=await le.updateUserProfile(t),a=ie(s.data);return e("set_user_profile",a),a}catch(s){throw e("set_error",s.message),s}finally{e("set_loading",!1)}},async uploadProfilePicture({commit:e,rootGetters:t},s){e("set_loading",!0);try{const a=await le.uploadProfilePicture(s),r=t["auth/currentUser"];if(a.data&&r){const t=ne(a.data.profile_picture),s={...r,profile_picture:t};e("auth/set_user",s,{root:!0}),e("update_user",s),e("set_user_profile",s),localStorage.setItem("user",JSON.stringify(s)),console.log("Final profile picture path saved:",t)}return a.data}catch(a){throw e("set_error",a.message),a}finally{e("set_loading",!1)}},async uploadBackgroundImage({commit:e,rootGetters:t},s){e("set_loading",!0);try{const a=await le.uploadBackgroundImage(s),r=t["auth/currentUser"];if(a.data&&r){const t={...r,background_image:a.data.background_image};return e("auth/set_user",t,{root:!0}),localStorage.setItem("user",JSON.stringify(t)),a.data}return a.data}catch(a){throw e("set_error",a.message),a}finally{e("set_loading",!1)}},async fixProfilePicturePaths({commit:e,rootGetters:t}){e("fix_profile_picture_paths");const s=t["auth/currentUser"];if(s&&s.profile_picture){const t=ne(s.profile_picture);if(t!==s.profile_picture){const a={...s,profile_picture:t};e("auth/set_user",a,{root:!0}),localStorage.setItem("user",JSON.stringify(a))}}}},me={set_loading(e,t){e.loading=t},set_error(e,t){e.error=t},set_users(e,t){e.users=t},set_user_profile(e,t){e.userProfiles={...e.userProfiles,[t.id]:t}},set_followers(e,t){e.followers=t},set_following(e,t){e.following=t},set_search_results(e,t){e.searchResults=t},set_search_loading(e,t){e.searchLoading=t},set_search_error(e,t){e.searchError=t},update_user(e,t){const s=e.users.findIndex((e=>e.id===t.id));-1!==s&&(e.users[s]=t)},fix_profile_picture_paths(e){e.users=e.users.map((e=>ie(e))),Object.keys(e.userProfiles).forEach((t=>{e.userProfiles[t]=ie(e.userProfiles[t])})),e.followers=e.followers.map((e=>ie(e))),e.following=e.following.map((e=>ie(e)))}};var pe={namespaced:!0,state:ce,getters:de,actions:ue,mutations:me},fe={getReels(e=10,t=0,s=null){const a=s?`&user_id=${s}`:"";return V.get(`/reels/?limit=${e}&skip=${t}${a}`)},getReelById(e){return V.get(`/reels/${e}`)},createReel(e,t={}){const s=new FormData;s.append("title",e.title),s.append("description",e.description),e.videoFile&&e.videoFile instanceof File?(console.log("Uploading video file:",{name:e.videoFile.name,type:e.videoFile.type,size:e.videoFile.size}),s.append("video_file",e.videoFile,e.videoFile.name)):console.error("Invalid video file:",e.videoFile);for(let[a,r]of s.entries())console.log(`Form data: ${a} = ${r instanceof File?r.name:r}`);return V.post("/reels/",s,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4,...t})},updateReel(e,t,s={}){const a=new FormData;return a.append("title",t.title),a.append("description",t.description),t.videoFile&&t.videoFile instanceof File&&(console.log("Updating with new video file:",{name:t.videoFile.name,type:t.videoFile.type,size:t.videoFile.size}),a.append("video_file",t.videoFile,t.videoFile.name)),V.put(`/reels/${e}`,a,{headers:{"Content-Type":"multipart/form-data"},timeout:6e4,...s})},deleteReel(e){return V.delete(`/reels/${e}`)},likeReel(e){return V.post("/reels/like/",{reel_id:e})},commentOnReel(e,t){return V.post(`/reels/${e}/comment`,{content:t})},getReelComments(e){return V.get(`/reels/${e}/comments`)}};const ve={reels:[],currentReel:null,loading:!1,error:null,reelComments:{}},ge={allReels:e=>e.reels,getCurrentReel:e=>e.currentReel,getReelComments:e=>t=>e.reelComments[t]||[]},ke={async fetchReels({commit:e},{limit:t=10,skip:s=0,userId:a=null}){e("set_loading",!0),e("set_error",null);try{const r=await fe.getReels(t,s,a);return console.log("Reels fetched successfully:",r.data),e("set_reels",r.data),r.data}catch(r){return console.error("Error fetching reels:",r),e("set_error",r.message||"Failed to fetch reels"),[]}finally{e("set_loading",!1)}},async fetchReelById({commit:e},t){e("set_loading",!0),e("set_error",null);try{const s=await fe.getReelById(t);return console.log("Reel fetched successfully:",s.data),e("set_current_reel",s.data),s.data}catch(s){return console.error("Error fetching reel by ID:",s),e("set_error",s.message||"Failed to fetch reel"),null}finally{e("set_loading",!1)}},async createReel({commit:e},t){e("set_loading",!0),e("set_error",null);try{let s={};t.config&&(s=t.config,delete t.config);const a=await fe.createReel(t,s);return console.log("Reel created successfully:",a.data),e("add_reel",a.data),a.data}catch(s){return console.error("Error creating reel:",s),e("set_error",s.message||"Failed to create reel"),null}finally{e("set_loading",!1)}},async updateReel({commit:e},{id:t,reelData:s,config:a={}}){e("set_loading",!0),e("set_error",null);try{const r=await fe.updateReel(t,s,a);return console.log("Reel updated successfully:",r.data),e("update_reel",r.data),ve.currentReel&&ve.currentReel.id===t&&e("set_current_reel",r.data),r.data}catch(r){return console.error("Error updating reel:",r),e("set_error",r.message||"Failed to update reel"),null}finally{e("set_loading",!1)}},async deleteReel({commit:e},t){e("set_loading",!0),e("set_error",null);try{return await fe.deleteReel(t),console.log("Reel deleted successfully:",t),e("remove_reel",t),!0}catch(s){return console.error("Error deleting reel:",s),e("set_error",s.message||"Failed to delete reel"),!1}finally{e("set_loading",!1)}},async likeReel({commit:e},t){e("set_error",null);try{const s=await fe.likeReel(t);return e("toggle_reel_like",{reelId:t,votes:s.data.votes,isLiked:s.data.is_liked}),!0}catch(s){return console.error("Error liking reel:",s),e("set_error",s.message||"Failed to like reel"),!1}},async fetchReelComments({commit:e},t){e("set_error",null);try{const s=await fe.getReelComments(t);return e("set_reel_comments",{reelId:t,comments:s.data}),s.data}catch(s){return console.error("Error fetching reel comments:",s),e("set_error",s.message||"Failed to fetch comments"),[]}},async commentOnReel({commit:e,dispatch:t},{reelId:s,content:a}){e("set_error",null);try{return await fe.commentOnReel(s,a),await t("fetchReelComments",s),!0}catch(r){return console.error("Error commenting on reel:",r),e("set_error",r.message||"Failed to post comment"),!1}}},be={set_loading(e,t){e.loading=t},set_error(e,t){e.error=t},set_reels(e,t){e.reels=t},add_reel(e,t){e.reels.unshift(t)},set_current_reel(e,t){e.currentReel=t},update_reel(e,t){const s=e.reels.findIndex((e=>e.id===t.id));-1!==s&&e.reels.splice(s,1,t)},remove_reel(e,t){e.reels=e.reels.filter((e=>e.id!==t)),e.currentReel&&e.currentReel.id===t&&(e.currentReel=null)},toggle_reel_like(e,{reelId:t,votes:s,isLiked:a}){const r=e.reels.find((e=>e.id===t));r&&(r.votes=s,r.is_liked=a),e.currentReel&&e.currentReel.id===t&&(e.currentReel.votes=s,e.currentReel.is_liked=a)},set_reel_comments(e,{reelId:t,comments:s}){e.reelComments={...e.reelComments,[t]:s}}};var he={namespaced:!0,state:ve,getters:ge,actions:ke,mutations:be},ye=(0,i.y$)({modules:{auth:O,posts:H,comments:ae,users:pe,reels:he}});const Le={class:"home-container"},we={class:"row"},_e={class:"col-lg-3 d-none d-lg-block"},Ce={class:"card mb-4"},Ee={class:"card-body"},Pe={class:"d-flex flex-column align-items-center text-center mb-3"},Re={class:"mb-0"},Fe={class:"text-muted mb-1"},Ue={class:"d-flex justify-content-around mb-2"},xe={class:"text-center"},Ie={class:"text-center"},We={class:"d-grid"},Xe={class:"card"},De={class:"card-body"},Ae={class:"list-group list-group-flush"},Se={class:"col-lg-6 col-md-8"},$e={class:"card mb-4"},Ke={class:"card-body"},Ve={class:"d-flex align-items-center mb-3"},Te={class:"d-flex justify-content-around"},qe={key:0,class:"text-center my-5"},Be={key:1,class:"card"},Qe={class:"card-body text-center py-5"},je={key:2},Oe={key:3,class:"text-center my-4"},Ne=["disabled"],Me={key:0,class:"spinner-border spinner-border-sm me-2"},ze={class:"col-lg-3 col-md-4 d-none d-md-block"},Je={class:"card mb-4"},Ge={class:"card-body"},He={key:0,class:"text-center my-3"},Ye={key:1,class:"text-muted text-center"},Ze={key:2},et={class:"flex-grow-1"},tt=["onClick","disabled"],st={key:0,class:"spinner-border spinner-border-sm"},at={key:1};function rt(e,t,s,l,o,n){const i=(0,r.g2)("UserAvatar"),d=(0,r.g2)("router-link"),u=(0,r.g2)("post-card");return(0,r.uX)(),(0,r.CE)("div",Le,[(0,r.Lk)("div",we,[(0,r.Lk)("div",_e,[(0,r.Lk)("div",Ce,[(0,r.Lk)("div",Ee,[(0,r.Lk)("div",Pe,[(0,r.bF)(i,{username:l.currentUser.username,profilePicture:l.currentUser.profile_picture,size:"lg",class:"mb-2"},null,8,["username","profilePicture"]),(0,r.Lk)("h5",Re,(0,c.v_)(l.currentUser.username),1),(0,r.Lk)("p",Fe,(0,c.v_)(l.currentUser.email),1)]),(0,r.Lk)("div",Ue,[(0,r.Lk)("div",xe,[(0,r.Lk)("h6",null,(0,c.v_)(l.followingCount),1),t[2]||(t[2]=(0,r.Lk)("small",{class:"text-muted"},"Following",-1))]),(0,r.Lk)("div",Ie,[(0,r.Lk)("h6",null,(0,c.v_)(l.followersCount),1),t[3]||(t[3]=(0,r.Lk)("small",{class:"text-muted"},"Followers",-1))])]),(0,r.Lk)("div",We,[(0,r.bF)(d,{to:`/profile/${l.currentUser.username}`,class:"btn btn-outline-primary"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.eW)(" View Profile ")]))),_:1},8,["to"])])])]),(0,r.Lk)("div",Xe,[(0,r.Lk)("div",De,[t[8]||(t[8]=(0,r.Lk)("h5",{class:"card-title"},"Quick Links",-1)),(0,r.Lk)("div",Ae,[(0,r.bF)(d,{to:"/",class:"list-group-item list-group-item-action"},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.Lk)("i",{class:"fas fa-home me-2"},null,-1),(0,r.eW)(" Home ")]))),_:1}),(0,r.bF)(d,{to:"/create-post",class:"list-group-item list-group-item-action"},{default:(0,r.k6)((()=>t[6]||(t[6]=[(0,r.Lk)("i",{class:"fas fa-edit me-2"},null,-1),(0,r.eW)(" Create Post ")]))),_:1}),(0,r.Lk)("a",{href:"#",onClick:t[0]||(t[0]=(0,a.D$)(((...e)=>l.refreshPosts&&l.refreshPosts(...e)),["prevent"])),class:"list-group-item list-group-item-action"},t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-sync-alt me-2"},null,-1),(0,r.eW)(" Refresh Feed ")]))])])])]),(0,r.Lk)("div",Se,[(0,r.Lk)("div",$e,[(0,r.Lk)("div",Ke,[(0,r.Lk)("div",Ve,[(0,r.bF)(i,{username:l.currentUser.username,profilePicture:l.currentUser.profile_picture,size:"sm",class:"me-2"},null,8,["username","profilePicture"]),(0,r.bF)(d,{to:"/create-post",class:"form-control text-start text-muted"},{default:(0,r.k6)((()=>[(0,r.eW)(" What's on your mind, "+(0,c.v_)(l.currentUser.username)+"? ",1)])),_:1})]),(0,r.Lk)("div",Te,[(0,r.bF)(d,{to:"/create-post",class:"btn btn-outline-primary flex-grow-1 mx-1"},{default:(0,r.k6)((()=>t[9]||(t[9]=[(0,r.Lk)("i",{class:"fas fa-edit me-1"},null,-1),(0,r.eW)(" Create Post ")]))),_:1})])])]),l.loading?((0,r.uX)(),(0,r.CE)("div",qe,t[10]||(t[10]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading posts...",-1)]))):0===l.posts.length?((0,r.uX)(),(0,r.CE)("div",Be,[(0,r.Lk)("div",Qe,[t[12]||(t[12]=(0,r.Lk)("i",{class:"fas fa-inbox fa-3x text-muted mb-3"},null,-1)),t[13]||(t[13]=(0,r.Lk)("h5",null,"No posts yet",-1)),t[14]||(t[14]=(0,r.Lk)("p",{class:"text-muted"},"Start by creating a post or following users.",-1)),(0,r.bF)(d,{to:"/create-post",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[11]||(t[11]=[(0,r.Lk)("i",{class:"fas fa-edit me-1"},null,-1),(0,r.eW)(" Create Post ")]))),_:1})])])):((0,r.uX)(),(0,r.CE)("div",je,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.posts,(e=>((0,r.uX)(),(0,r.Wv)(u,{key:e.id,post:e,onVote:l.handleVote},null,8,["post","onVote"])))),128))])),l.posts.length>0?((0,r.uX)(),(0,r.CE)("div",Oe,[(0,r.Lk)("button",{class:"btn btn-outline-primary",onClick:t[1]||(t[1]=(...e)=>l.loadMorePosts&&l.loadMorePosts(...e)),disabled:l.loading},[l.loading?((0,r.uX)(),(0,r.CE)("span",Me)):(0,r.Q3)("",!0),t[15]||(t[15]=(0,r.eW)(" Load More Posts "))],8,Ne)])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",ze,[(0,r.Lk)("div",Je,[(0,r.Lk)("div",Ge,[t[18]||(t[18]=(0,r.Lk)("h5",{class:"card-title"},"People to Follow",-1)),l.loadingUsers?((0,r.uX)(),(0,r.CE)("div",He,t[16]||(t[16]=[(0,r.Lk)("div",{class:"spinner-border spinner-border-sm text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1)]))):0===l.suggestedUsers.length?((0,r.uX)(),(0,r.CE)("div",Ye,t[17]||(t[17]=[(0,r.Lk)("p",null,"No suggestions available",-1)]))):((0,r.uX)(),(0,r.CE)("div",Ze,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.suggestedUsers,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"d-flex align-items-center mb-3"},[(0,r.bF)(i,{username:e.username,profilePicture:e.profile_picture,size:"sm",backgroundColor:"bg-secondary",class:"me-2"},null,8,["username","profilePicture"]),(0,r.Lk)("div",et,[(0,r.bF)(d,{to:`/profile/${e.username}`,class:"text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.Lk)("strong",null,(0,c.v_)(e.username),1)])),_:2},1032,["to"])]),(0,r.Lk)("button",{class:"btn btn-sm btn-primary follow-btn",onClick:t=>l.followUser(e.id),disabled:l.followingInProgress.includes(e.id)},[l.followingInProgress.includes(e.id)?((0,r.uX)(),(0,r.CE)("span",st)):((0,r.uX)(),(0,r.CE)("span",at,"Follow"))],8,tt)])))),128))]))])])])])])}const lt={class:"card mb-4"},ot={class:"card-body"},nt={class:"d-flex mb-3"},it={class:"mb-0"},ct={class:"text-muted"},dt={class:"card-title"},ut={class:"card-text"},mt={key:0,class:"text-primary mb-0"},pt={class:"d-flex justify-content-between align-items-center mt-3 pt-3 border-top"},ft={class:"d-flex align-items-center"};function vt(e,t,s,a,l,o){const n=(0,r.g2)("UserAvatar"),i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",lt,[(0,r.Lk)("div",ot,[(0,r.Lk)("div",nt,[(0,r.bF)(n,{username:s.post.owner.username,profilePicture:s.post.owner.profile_picture,size:"sm",class:"me-2",backgroundColor:"bg-secondary"},null,8,["username","profilePicture"]),(0,r.Lk)("div",null,[(0,r.bF)(i,{to:`/profile/${s.post.owner.username}`,class:"text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.Lk)("h6",it,(0,c.v_)(s.post.owner.username),1)])),_:1},8,["to"]),(0,r.Lk)("small",ct,(0,c.v_)(a.formattedDate),1)])]),(0,r.bF)(i,{to:`/posts/${s.post.id}`,class:"text-decoration-none text-dark"},{default:(0,r.k6)((()=>[(0,r.Lk)("h5",dt,(0,c.v_)(s.post.title),1),(0,r.Lk)("p",ut,(0,c.v_)(a.truncatedContent),1),a.isContentTruncated?((0,r.uX)(),(0,r.CE)("p",mt,"Read more...")):(0,r.Q3)("",!0)])),_:1},8,["to"]),(0,r.Lk)("div",pt,[(0,r.Lk)("div",ft,[(0,r.Lk)("button",{class:(0,c.C4)(["btn btn-sm",{"btn-primary":s.post.hasVoted,"btn-outline-primary":!s.post.hasVoted}]),onClick:t[0]||(t[0]=(...e)=>a.vote&&a.vote(...e))},[t[1]||(t[1]=(0,r.Lk)("i",{class:"fas fa-heart me-1"},null,-1)),(0,r.eW)(" "+(0,c.v_)(s.post.votes||0),1)],2),(0,r.bF)(i,{to:`/posts/${s.post.id}`,class:"btn btn-sm btn-outline-secondary ms-2"},{default:(0,r.k6)((()=>[t[2]||(t[2]=(0,r.Lk)("i",{class:"fas fa-comment me-1"},null,-1)),(0,r.eW)(" "+(0,c.v_)(a.commentsCount),1)])),_:1},8,["to"])]),(0,r.bF)(i,{to:`/posts/${s.post.id}`,class:"btn btn-sm btn-outline-primary"},{default:(0,r.k6)((()=>t[3]||(t[3]=[(0,r.eW)(" View Details ")]))),_:1},8,["to"])])])])}const gt={key:0};function kt(e,t,s,a,l,o){return(0,r.uX)(),(0,r.CE)("div",{class:(0,c.C4)(["user-avatar rounded-circle d-flex align-items-center justify-content-center",[a.sizeClass,s.backgroundColor]]),style:(0,c.Tr)(a.avatarStyle)},[s.profilePicture?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("span",gt,(0,c.v_)(a.initial),1))],6)}var bt={name:"UserAvatar",props:{username:{type:String,required:!0},profilePicture:{type:String,default:null},size:{type:String,default:"md",validator:e=>["sm","md","lg"].includes(e)},backgroundColor:{type:String,default:"bg-primary"}},setup(e){const t=(0,r.EW)((()=>e.username?.charAt(0).toUpperCase()||"")),s=(0,r.EW)((()=>{switch(e.size){case"sm":return"avatar-sm";case"lg":return"avatar-lg";default:return"avatar-md"}})),a=(0,r.EW)((()=>e.profilePicture&&""!==e.profilePicture.trim()?(console.log("Using profile picture:",e.profilePicture),{backgroundImage:`url(${e.profilePicture})`,backgroundSize:"cover",backgroundPosition:"center"}):(console.log("No valid profile picture found, using initial"),{})));return{initial:t,sizeClass:s,avatarStyle:a}}};const ht=(0,_.A)(bt,[["render",kt],["__scopeId","data-v-1dc1a86a"]]);var yt=ht,Lt={name:"PostCard",components:{UserAvatar:yt},props:{post:{type:Object,required:!0}},emits:["vote"],setup(e,{emit:t}){const s=(0,i.Pj)(),a=200,l=(0,y.KR)(0),o=(0,r.EW)((()=>s.getters["auth/currentUser"]||{})),n=(0,r.EW)((()=>o.value.id===e.post.owner_id)),c=(0,r.EW)((()=>e.post.content.length<=a?e.post.content:e.post.content.substring(0,a)+"...")),d=(0,r.EW)((()=>e.post.content.length>a)),u=(0,r.EW)((()=>{const t=new Date(e.post.created_at);return t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})})),m=()=>{t("vote",e.post.id)},p=async()=>{if(confirm("Are you sure you want to delete this post?")){await s.dispatch("posts/deletePost",e.post.id)}},f=async()=>{try{const t=await s.dispatch("comments/fetchComments",e.post.id);l.value=t.length}catch(t){console.error("Failed to fetch comments:",t)}};return f(),{currentUser:o,isOwner:n,truncatedContent:c,isContentTruncated:d,formattedDate:u,vote:m,confirmDelete:p,commentsCount:l}}};const wt=(0,_.A)(Lt,[["render",vt],["__scopeId","data-v-6cf3fe57"]]);var _t=wt,Ct={name:"HomePage",components:{PostCard:_t,UserAvatar:yt},setup(){const e=(0,i.Pj)(),t=(0,y.KR)(10),s=(0,y.KR)(0),a=(0,y.KR)(""),l=(0,y.KR)([]),o=(0,r.EW)((()=>e.getters["auth/currentUser"]||{})),n=(0,r.EW)((()=>e.getters["posts/allPosts"])),c=(0,r.EW)((()=>e.state.posts.loading)),d=(0,r.EW)((()=>e.state.users.loading)),u=(0,r.EW)((()=>e.getters["users/allUsers"])),m=(0,r.EW)((()=>e.getters["users/following"]||[])),p=(0,r.EW)((()=>m.value.length)),f=(0,r.EW)((()=>e.getters["users/followers"]?.length||0)),v=(0,r.EW)((()=>{const e=m.value.map((e=>e.id));return u.value.filter((t=>t.id!==o.value.id&&!e.includes(t.id))).slice(0,5)})),g=async()=>{await e.dispatch("posts/fetchPosts",{limit:t.value,skip:s.value,search:a.value})},k=async()=>{s.value+=t.value,await g()},b=async()=>{s.value=0,await g()},h=async t=>{await e.dispatch("posts/votePost",t)},L=async t=>{l.value.push(t);try{await e.dispatch("users/followUser",t),e.dispatch("users/fetchUsers"),e.dispatch("users/fetchFollowing")}finally{l.value=l.value.filter((e=>e!==t))}};return(0,r.sV)((async()=>{await g(),await e.dispatch("users/fetchUsers"),await e.dispatch("users/fetchFollowing"),await e.dispatch("users/fetchFollowers")})),{currentUser:o,posts:n,loading:c,loadingUsers:d,loadMorePosts:k,refreshPosts:b,handleVote:h,suggestedUsers:v,followingCount:p,followersCount:f,followUser:L,followingInProgress:l}}};const Et=(0,_.A)(Ct,[["render",rt],["__scopeId","data-v-8c189abe"]]);var Pt=Et;const Rt={class:"login-container"},Ft={class:"row justify-content-center"},Ut={class:"col-md-6 col-lg-5"},xt={class:"card shadow"},It={class:"card-body p-5"},Wt={key:0,class:"alert alert-danger"},Xt={class:"mb-3"},Dt=["disabled"],At={class:"mb-3"},St={class:"password-field"},$t=["disabled"],Kt={class:"d-grid gap-2 mt-4"},Vt=["disabled"],Tt={key:0,class:"spinner-border spinner-border-sm me-2"},qt={class:"text-center mt-4"},Bt={class:"register-link"};function Qt(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Rt,[(0,r.Lk)("div",Ft,[(0,r.Lk)("div",Ut,[(0,r.Lk)("div",xt,[(0,r.Lk)("div",It,[t[7]||(t[7]=(0,r.Lk)("h2",{class:"text-center mb-4 app-title"},"Login",-1)),l.error?((0,r.uX)(),(0,r.CE)("div",Wt,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("form",{onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))},[(0,r.Lk)("div",Xt,[t[3]||(t[3]=(0,r.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>l.username=e),required:"",disabled:l.loading,placeholder:"Enter your username"},null,8,Dt),[[a.Jo,l.username]])]),(0,r.Lk)("div",At,[t[4]||(t[4]=(0,r.Lk)("label",{for:"password",class:"form-label"},"Password",-1)),(0,r.Lk)("div",St,[(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[1]||(t[1]=e=>l.password=e),required:"",disabled:l.loading,placeholder:"Enter your password"},null,8,$t),[[a.Jo,l.password]])])]),(0,r.Lk)("div",Kt,[(0,r.Lk)("button",{type:"submit",class:"btn btn-primary btn-lg login-btn",disabled:l.loading},[l.loading?((0,r.uX)(),(0,r.CE)("span",Tt)):(0,r.Q3)("",!0),(0,r.Lk)("span",null,(0,c.v_)(l.loading?"Logging in...":"Login"),1)],8,Vt)])],32),(0,r.Lk)("div",qt,[(0,r.Lk)("p",Bt,[t[6]||(t[6]=(0,r.eW)(" Don't have an account? ")),(0,r.bF)(i,{to:"/register",class:"register-btn"},{default:(0,r.k6)((()=>t[5]||(t[5]=[(0,r.eW)("Register")]))),_:1})])])])])])])])}var jt={name:"LoginPage",setup(){const e=(0,i.Pj)(),t=(0,L.rd)(),s=(0,L.lq)(),a=(0,y.KR)(""),l=(0,y.KR)(""),o=(0,y.KR)(""),n=(0,r.EW)((()=>"loading"===e.state.auth.status)),c=async()=>{if(o.value="",a.value&&l.value)try{e.commit("auth/auth_request");const r=await e.dispatch("auth/login",{username:a.value,password:l.value});if(r){const e=s.query.redirect||"/";t.push(e)}else o.value="Login failed. Please check your credentials."}catch(r){if(r.response)switch(r.response.status){case 401:o.value="Invalid username or password";break;case 404:o.value="Server not found. Please check your connection.";break;case 500:o.value="Server error. Please try again later.";break;default:o.value=r.response.data?.detail||"An unexpected error occurred"}else r.request?o.value="No response from server. Please check your network connection.":o.value="Error setting up login request. Please try again.";console.error("Login error:",r),e.commit("auth/auth_error")}else o.value="Please enter both username and password"};return{username:a,password:l,error:o,loading:n,handleSubmit:c}}};const Ot=(0,_.A)(jt,[["render",Qt],["__scopeId","data-v-86de2134"]]);var Nt=Ot;const Mt={class:"register-container"},zt={class:"row justify-content-center"},Jt={class:"col-md-8 col-lg-6"},Gt={class:"card shadow"},Ht={class:"card-body p-5"},Yt={key:0,class:"alert alert-danger"},Zt={class:"mb-3"},es=["disabled"],ts={class:"mb-3"},ss=["disabled"],as={class:"mb-3"},rs=["disabled"],ls={class:"mb-3"},os=["disabled"],ns={class:"mb-3"},is=["disabled"],cs={class:"d-grid gap-2"},ds=["disabled"],us={key:0,class:"spinner-border spinner-border-sm me-2"},ms={class:"text-center mt-4"};function ps(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Mt,[(0,r.Lk)("div",zt,[(0,r.Lk)("div",Jt,[(0,r.Lk)("div",Gt,[(0,r.Lk)("div",Ht,[t[15]||(t[15]=(0,r.Lk)("h2",{class:"text-center mb-4"},"Create an Account",-1)),l.error?((0,r.uX)(),(0,r.CE)("div",Yt,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("form",{onSubmit:t[5]||(t[5]=(0,a.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))},[(0,r.Lk)("div",Zt,[t[6]||(t[6]=(0,r.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":t[0]||(t[0]=e=>l.formData.username=e),required:"",disabled:l.loading},null,8,es),[[a.Jo,l.formData.username]])]),(0,r.Lk)("div",ts,[t[7]||(t[7]=(0,r.Lk)("label",{for:"email",class:"form-label"},"Email",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[1]||(t[1]=e=>l.formData.email=e),required:"",disabled:l.loading},null,8,ss),[[a.Jo,l.formData.email]])]),(0,r.Lk)("div",as,[t[8]||(t[8]=(0,r.Lk)("label",{for:"phone_number",class:"form-label"},"Phone Number",-1)),(0,r.bo)((0,r.Lk)("input",{type:"tel",class:"form-control",id:"phone_number","onUpdate:modelValue":t[2]||(t[2]=e=>l.formData.phone_number=e),required:"",disabled:l.loading},null,8,rs),[[a.Jo,l.formData.phone_number]])]),(0,r.Lk)("div",ls,[t[9]||(t[9]=(0,r.Lk)("label",{for:"password",class:"form-label"},"Password",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[3]||(t[3]=e=>l.formData.password=e),required:"",disabled:l.loading},null,8,os),[[a.Jo,l.formData.password]]),t[10]||(t[10]=(0,r.Lk)("div",{class:"form-text"}," Password must be at least 8 characters with uppercase, lowercase, numbers, and special characters. ",-1))]),(0,r.Lk)("div",ns,[t[11]||(t[11]=(0,r.Lk)("label",{for:"password_confirm",class:"form-label"},"Confirm Password",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"password_confirm","onUpdate:modelValue":t[4]||(t[4]=e=>l.formData.password_confirm=e),required:"",disabled:l.loading},null,8,is),[[a.Jo,l.formData.password_confirm]])]),(0,r.Lk)("div",cs,[(0,r.Lk)("button",{type:"submit",class:"btn btn-primary btn-lg",disabled:l.loading},[l.loading?((0,r.uX)(),(0,r.CE)("span",us)):(0,r.Q3)("",!0),t[12]||(t[12]=(0,r.eW)(" Register "))],8,ds)])],32),(0,r.Lk)("div",ms,[(0,r.Lk)("p",null,[t[14]||(t[14]=(0,r.eW)("Already have an account? ")),(0,r.bF)(i,{to:"/login"},{default:(0,r.k6)((()=>t[13]||(t[13]=[(0,r.eW)("Login")]))),_:1})])])])])])])])}var fs={name:"UserRegister",setup(){const e=(0,i.Pj)(),t=(0,L.rd)(),s=(0,y.Kh)({username:"",email:"",phone_number:"",password:"",password_confirm:""}),a=(0,y.KR)(""),l=(0,r.EW)((()=>"loading"===e.state.auth.status)),o=async()=>{if(a.value="",s.password!==s.password_confirm)return void(a.value="Passwords do not match");const r=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;if(r.test(s.password))try{const a={...s,phone_number:parseInt(s.phone_number,10)},r=await e.dispatch("auth/register",a);r&&t.push("/")}catch(l){l.response&&l.response.data?a.value=l.response.data.detail||"Registration failed":a.value="Registration failed. Please try again."}else a.value="Password must be at least 8 characters with uppercase, lowercase, numbers, and special characters"};return{formData:s,error:a,loading:l,handleSubmit:o}}};const vs=(0,_.A)(fs,[["render",ps],["__scopeId","data-v-9b822f14"]]);var gs=vs;const ks={class:"profile-container"},bs={key:0,class:"text-center my-5"},hs={key:1,class:"alert alert-warning"},ys={key:2,class:"profile-content"},Ls={class:"profile-header bg-white shadow-sm rounded-3 mb-4"},ws={class:"profile-avatar-container"},_s={key:0},Cs={class:"profile-info text-center mt-5 pb-3"},Es={class:"mb-1"},Ps={class:"text-muted mb-2"},Rs={class:"text-muted"},Fs={class:"profile-actions mt-3"},Us=["disabled"],xs={key:0,class:"spinner-border spinner-border-sm me-2"},Is={class:"profile-stats border-top py-3"},Ws={class:"row text-center"},Xs={class:"col"},Ds={class:"mb-0"},As={class:"col"},Ss={class:"mb-0"},$s={class:"col"},Ks={class:"mb-0"},Vs={class:"tab-content"},Ts={class:"tab-pane fade show active",id:"posts"},qs={key:0,class:"text-center my-5"},Bs={key:1,class:"alert alert-info text-center"},Qs={key:2},js={class:"tab-pane fade",id:"reels"},Os={key:0,class:"text-center my-5"},Ns={key:1,class:"alert alert-info text-center"},Ms={key:2,class:"row g-4"},zs={class:"card reel-card h-100 overflow-hidden"},Js={class:"reel-preview position-relative"},Gs=["src"],Hs={class:"reel-overlay position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"},Ys={class:"card-body"},Zs={class:"card-title"},ea={class:"d-flex justify-content-between align-items-center"},ta={class:"text-muted"},sa={class:"text-muted"};function aa(e,t,s,a,l,o){const n=(0,r.g2)("router-link"),i=(0,r.g2)("PostCard");return(0,r.uX)(),(0,r.CE)("div",ks,[a.loading?((0,r.uX)(),(0,r.CE)("div",bs,t[1]||(t[1]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading profile...",-1)]))):a.profile?((0,r.uX)(),(0,r.CE)("div",ys,[(0,r.Lk)("div",Ls,[(0,r.Lk)("div",{class:"cover-photo position-relative",style:(0,c.Tr)(a.backgroundImageStyle)},[(0,r.Lk)("div",ws,[(0,r.Lk)("div",{class:(0,c.C4)(["profile-avatar text-white rounded-circle",{"bg-primary":!a.profile.profile_picture}]),style:(0,c.Tr)(a.profilePictureStyle)},[a.profile.profile_picture?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("span",_s,(0,c.v_)(a.userInitial),1))],6)])],4),(0,r.Lk)("div",Cs,[(0,r.Lk)("h2",Es,(0,c.v_)(a.profile.username),1),(0,r.Lk)("p",Ps,[t[2]||(t[2]=(0,r.Lk)("i",{class:"fas fa-envelope me-2"},null,-1)),(0,r.eW)((0,c.v_)(a.profile.email),1)]),(0,r.Lk)("p",Rs,[t[3]||(t[3]=(0,r.Lk)("i",{class:"fas fa-calendar-alt me-2"},null,-1)),(0,r.eW)("Joined "+(0,c.v_)(a.formattedJoinDate),1)]),(0,r.Lk)("div",Fs,[a.isCurrentUser?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("button",{key:0,class:(0,c.C4)(["btn me-2",{"btn-primary":!a.isFollowing,"btn-outline-primary":a.isFollowing}]),onClick:t[0]||(t[0]=e=>a.isFollowing?a.unfollowUser():a.followUser()),disabled:a.followActionInProgress},[a.followActionInProgress?((0,r.uX)(),(0,r.CE)("span",xs)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,c.v_)(a.isFollowing?"Unfollow":"Follow"),1)],10,Us)),a.isCurrentUser?((0,r.uX)(),(0,r.Wv)(n,{key:1,to:"/edit-profile",class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[4]||(t[4]=[(0,r.Lk)("i",{class:"fas fa-edit me-2"},null,-1),(0,r.eW)("Edit Profile ")]))),_:1})):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",Is,[(0,r.Lk)("div",Ws,[(0,r.Lk)("div",Xs,[(0,r.Lk)("h4",Ds,(0,c.v_)(a.userPosts.length),1),t[5]||(t[5]=(0,r.Lk)("small",{class:"text-muted"},"Posts",-1))]),(0,r.Lk)("div",As,[(0,r.Lk)("h4",Ss,(0,c.v_)(a.followersCount),1),t[6]||(t[6]=(0,r.Lk)("small",{class:"text-muted"},"Followers",-1))]),(0,r.Lk)("div",$s,[(0,r.Lk)("h4",Ks,(0,c.v_)(a.followingCount),1),t[7]||(t[7]=(0,r.Lk)("small",{class:"text-muted"},"Following",-1))])])])]),t[19]||(t[19]=(0,r.Fv)('<ul class="nav nav-tabs mb-4" id="profileTabs" data-v-371bbce7><li class="nav-item" data-v-371bbce7><a class="nav-link active" data-bs-toggle="tab" href="#posts" data-v-371bbce7><i class="fas fa-th me-2" data-v-371bbce7></i>Posts </a></li><li class="nav-item" data-v-371bbce7><a class="nav-link" data-bs-toggle="tab" href="#reels" data-v-371bbce7><i class="fas fa-film me-2" data-v-371bbce7></i>Reels </a></li></ul>',1)),(0,r.Lk)("div",Vs,[(0,r.Lk)("div",Ts,[a.loadingPosts?((0,r.uX)(),(0,r.CE)("div",qs,t[8]||(t[8]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading posts...")],-1)]))):0===a.userPosts.length?((0,r.uX)(),(0,r.CE)("div",Bs,[t[10]||(t[10]=(0,r.Lk)("i",{class:"fas fa-inbox fa-3x mb-3"},null,-1)),t[11]||(t[11]=(0,r.Lk)("p",null,"No posts yet",-1)),a.isCurrentUser?((0,r.uX)(),(0,r.Wv)(n,{key:0,to:"/create-post",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[9]||(t[9]=[(0,r.eW)(" Create First Post ")]))),_:1})):(0,r.Q3)("",!0)])):((0,r.uX)(),(0,r.CE)("div",Qs,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.userPosts,(e=>((0,r.uX)(),(0,r.Wv)(i,{key:e.id,post:e,onVote:a.handleVote},null,8,["post","onVote"])))),128))]))]),(0,r.Lk)("div",js,[a.loadingReels?((0,r.uX)(),(0,r.CE)("div",Os,t[12]||(t[12]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading reels...")],-1)]))):0===a.userReels.length?((0,r.uX)(),(0,r.CE)("div",Ns,[t[14]||(t[14]=(0,r.Lk)("i",{class:"fas fa-film fa-3x mb-3"},null,-1)),t[15]||(t[15]=(0,r.Lk)("p",null,"No reels yet",-1)),a.isCurrentUser?((0,r.uX)(),(0,r.Wv)(n,{key:0,to:"/create-reel",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[13]||(t[13]=[(0,r.eW)(" Create First Reel ")]))),_:1})):(0,r.Q3)("",!0)])):((0,r.uX)(),(0,r.CE)("div",Ms,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.userReels,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"col-md-4 mb-4"},[(0,r.Lk)("div",zs,[(0,r.Lk)("div",Js,[(0,r.Lk)("video",{class:"card-img-top",src:e.video_url,preload:"metadata"},null,8,Gs),(0,r.Lk)("div",Hs,[(0,r.bF)(n,{to:`/reels/${e.id}`,class:"btn btn-light btn-play"},{default:(0,r.k6)((()=>t[16]||(t[16]=[(0,r.Lk)("i",{class:"fas fa-play"},null,-1)]))),_:2},1032,["to"])])]),(0,r.Lk)("div",Ys,[(0,r.Lk)("h5",Zs,(0,c.v_)(e.title),1),(0,r.Lk)("div",ea,[(0,r.Lk)("small",ta,[t[17]||(t[17]=(0,r.Lk)("i",{class:"fas fa-heart me-1"},null,-1)),(0,r.eW)((0,c.v_)(e.likes||0),1)]),(0,r.Lk)("small",sa,[t[18]||(t[18]=(0,r.Lk)("i",{class:"fas fa-comment me-1"},null,-1)),(0,r.eW)((0,c.v_)(e.comments_count||0),1)])])])])])))),128))]))])])])):((0,r.uX)(),(0,r.CE)("div",hs," User not found. "))])}var ra={name:"UserProfile",components:{PostCard:_t},setup(){const e=(0,i.Pj)(),t=(0,L.lq)(),s=(0,y.KR)(t.params.username),a=(0,y.KR)(!0),l=(0,y.KR)(!0),o=(0,y.KR)(!0),n=(0,y.KR)(!0),c=(0,y.KR)(!0),d=(0,y.KR)(!1),u=(0,y.KR)([]),m=(0,y.KR)([]),p=(0,r.EW)((()=>e.getters["auth/currentUser"]||{})),f=(0,r.EW)((()=>e.getters["users/allUsers"])),v=(0,r.EW)((()=>e.getters["posts/allPosts"])),g=(0,r.EW)((()=>f.value.find((e=>e.username===s.value)))),k=(0,r.EW)((()=>g.value?.username?.charAt(0).toUpperCase()||"")),b=(0,r.EW)((()=>p.value.id===g.value?.id)),h=(0,r.EW)((()=>{if(g.value?.profile_picture){console.log("Raw profile picture URL:",g.value.profile_picture);let e=g.value.profile_picture;return e.startsWith("/http")&&(e=e.substring(1),console.log("Fixed URL:",e)),{backgroundImage:`url(${e})`,backgroundSize:"cover",backgroundPosition:"center"}}return{}})),w=(0,r.EW)((()=>e.getters["users/followers"]||[])),_=(0,r.EW)((()=>e.getters["users/following"]||[])),C=(0,r.EW)((()=>w.value.length)),E=(0,r.EW)((()=>_.value.length)),P=(0,r.EW)((()=>!!g.value&&_.value.some((e=>e.id===g.value.id)))),R=(0,r.EW)((()=>{if(!g.value?.created_at)return"";const e=new Date(g.value.created_at);return e.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})})),F=(0,r.EW)((()=>g.value?.background_image?{backgroundImage:`url(${g.value.background_image})`,backgroundSize:"cover",backgroundPosition:"center",height:"200px",position:"relative"}:{background:"linear-gradient(135deg, #0d6efd 0%, #6610f2 100%)",height:"200px",position:"relative"})),U=async()=>{a.value=!0;try{if(0===f.value.length&&await e.dispatch("users/fetchUsers"),!g.value)try{await e.dispatch("users/fetchUserByUsername",s.value)}catch(t){console.error("User not found:",t)}}finally{a.value=!1}},x=async()=>{l.value=!0;try{await e.dispatch("posts/fetchPosts",{limit:100,skip:0,search:""}),g.value&&(u.value=v.value.filter((e=>e.owner_id===g.value.id)))}finally{l.value=!1}},I=async()=>{c.value=!0;try{if(g.value){const t=await e.dispatch("reels/fetchReels",{userId:g.value.id,limit:100,skip:0});m.value=t}}catch(t){console.error("Failed to fetch user reels:",t)}finally{c.value=!1}},W=async()=>{if(b.value){o.value=!0,n.value=!0;try{await e.dispatch("users/fetchFollowers"),await e.dispatch("users/fetchFollowing")}finally{o.value=!1,n.value=!1}}else await e.dispatch("users/fetchFollowing")},X=async()=>{if(g.value){d.value=!0;try{await e.dispatch("users/followUser",g.value.id)}finally{d.value=!1}}},D=async()=>{if(g.value){d.value=!0;try{await e.dispatch("users/unfollowUser",g.value.id)}finally{d.value=!1}}},A=async t=>{await e.dispatch("posts/votePost",t)};return(0,r.wB)((()=>t.params.username),(e=>{s.value=e,U(),x(),I(),W()})),(0,r.sV)((async()=>{await U(),await x(),await I(),await W()})),{profile:g,loading:a,loadingPosts:l,loadingFollowers:o,loadingFollowing:n,loadingReels:c,userPosts:u,userReels:m,userInitial:k,isCurrentUser:b,followers:w,following:_,followersCount:C,followingCount:E,isFollowing:P,formattedJoinDate:R,followUser:X,unfollowUser:D,followActionInProgress:d,handleVote:A,profilePictureStyle:h,backgroundImageStyle:F}}};const la=(0,_.A)(ra,[["render",aa],["__scopeId","data-v-371bbce7"]]);var oa=la;const na={key:0,class:"text-center my-5"},ia={key:1,class:"alert alert-warning"},ca={key:2,class:"post-detail"},da={class:"card mb-4"},ua={class:"card-body"},ma={class:"d-flex align-items-center mb-3"},pa={class:"mb-0"},fa={class:"text-muted"},va={key:0,class:"dropdown ms-auto"},ga={class:"dropdown-menu dropdown-menu-end"},ka={class:"card-title"},ba={class:"card-text"},ha={class:"d-flex justify-content-between align-items-center mt-4 pt-3 border-top"},ya={class:"d-flex align-items-center"},La={class:"btn btn-outline-secondary ms-2",disabled:""},wa={key:0},_a={class:"card"},Ca={class:"card-header bg-white"},Ea={class:"mb-0"},Pa={class:"card-body"},Ra={class:"mb-4"},Fa={class:"d-flex"},Ua={class:"flex-grow-1"},xa={class:"text-end"},Ia=["disabled"],Wa={key:0,class:"spinner-border spinner-border-sm me-1"},Xa={key:0,class:"text-center my-4"},Da={key:1,class:"text-center my-4"},Aa={key:2},Sa={class:"d-flex"},$a={class:"flex-grow-1"},Ka={class:"comment-bubble p-3"},Va={class:"d-flex justify-content-between mb-1"},Ta={class:"text-muted"},qa={class:"mb-0"};function Ba(e,t,s,l,o,n){const i=(0,r.g2)("UserAvatar"),d=(0,r.g2)("router-link");return l.loading?((0,r.uX)(),(0,r.CE)("div",na,t[5]||(t[5]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading post...",-1)]))):l.post?((0,r.uX)(),(0,r.CE)("div",ca,[(0,r.Lk)("div",da,[(0,r.Lk)("div",ua,[(0,r.Lk)("div",ma,[(0,r.bF)(i,{username:l.post.owner.username,profilePicture:l.post.owner.profile_picture,size:"md",class:"me-3",backgroundColor:"bg-secondary"},null,8,["username","profilePicture"]),(0,r.Lk)("div",null,[(0,r.bF)(d,{to:`/profile/${l.post.owner.username}`,class:"text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.Lk)("h5",pa,(0,c.v_)(l.post.owner.username),1)])),_:1},8,["to"]),(0,r.Lk)("small",fa,(0,c.v_)(l.formattedDate),1)]),l.isOwner?((0,r.uX)(),(0,r.CE)("div",va,[t[8]||(t[8]=(0,r.Lk)("button",{class:"btn btn-sm",type:"button","data-bs-toggle":"dropdown"},[(0,r.Lk)("i",{class:"fas fa-ellipsis-v"})],-1)),(0,r.Lk)("ul",ga,[(0,r.Lk)("li",null,[(0,r.bF)(d,{to:`/edit-post/${l.post.id}`,class:"dropdown-item"},{default:(0,r.k6)((()=>t[6]||(t[6]=[(0,r.Lk)("i",{class:"fas fa-edit me-2"},null,-1),(0,r.eW)(" Edit ")]))),_:1},8,["to"])]),(0,r.Lk)("li",null,[(0,r.Lk)("a",{href:"#",class:"dropdown-item text-danger",onClick:t[0]||(t[0]=(0,a.D$)(((...e)=>l.confirmDelete&&l.confirmDelete(...e)),["prevent"]))},t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-trash-alt me-2"},null,-1),(0,r.eW)(" Delete ")]))])])])):(0,r.Q3)("",!0)]),(0,r.Lk)("h2",ka,(0,c.v_)(l.post.title),1),(0,r.Lk)("p",ba,(0,c.v_)(l.post.content),1),(0,r.Lk)("div",ha,[(0,r.Lk)("div",ya,[(0,r.Lk)("button",{class:(0,c.C4)(["btn",{"btn-primary":l.post.hasVoted,"btn-outline-primary":!l.post.hasVoted}]),onClick:t[1]||(t[1]=(...e)=>l.vote&&l.vote(...e))},[t[9]||(t[9]=(0,r.Lk)("i",{class:"fas fa-heart me-1"},null,-1)),(0,r.eW)(" "+(0,c.v_)(l.post.votes||0),1)],2),(0,r.Lk)("button",La,[t[10]||(t[10]=(0,r.Lk)("i",{class:"fas fa-comment me-1"},null,-1)),(0,r.eW)(" "+(0,c.v_)(l.comments.length),1)])]),l.isOwner?((0,r.uX)(),(0,r.CE)("div",wa,[(0,r.bF)(d,{to:`/edit-post/${l.post.id}`,class:"btn btn-primary"},{default:(0,r.k6)((()=>t[11]||(t[11]=[(0,r.Lk)("i",{class:"fas fa-edit me-1"},null,-1),(0,r.eW)(" Edit ")]))),_:1},8,["to"]),(0,r.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.confirmDelete&&l.confirmDelete(...e)),class:"btn btn-danger ms-2"},t[12]||(t[12]=[(0,r.Lk)("i",{class:"fas fa-trash-alt me-1"},null,-1),(0,r.eW)(" Delete ")]))])):(0,r.Q3)("",!0)])])]),(0,r.Lk)("div",_a,[(0,r.Lk)("div",Ca,[(0,r.Lk)("h5",Ea,"Comments ("+(0,c.v_)(l.comments.length)+")",1)]),(0,r.Lk)("div",Pa,[(0,r.Lk)("div",Ra,[(0,r.Lk)("div",Fa,[(0,r.bF)(i,{username:l.currentUser.username,profilePicture:l.currentUser.profile_picture,size:"sm",class:"me-2",backgroundColor:"bg-primary"},null,8,["username","profilePicture"]),(0,r.Lk)("div",Ua,[(0,r.bo)((0,r.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.newComment=e),class:"form-control mb-2",rows:"2",placeholder:"Write a comment..."},null,512),[[a.Jo,l.newComment]]),(0,r.Lk)("div",xa,[(0,r.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>l.addComment&&l.addComment(...e)),class:"btn btn-primary",disabled:!l.newComment.trim()||l.commentLoading},[l.commentLoading?((0,r.uX)(),(0,r.CE)("span",Wa)):(0,r.Q3)("",!0),t[13]||(t[13]=(0,r.eW)(" Post Comment "))],8,Ia)])])])]),l.commentsLoading?((0,r.uX)(),(0,r.CE)("div",Xa,t[14]||(t[14]=[(0,r.Lk)("div",{class:"spinner-border spinner-border-sm text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading comments...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading comments...",-1)]))):0===l.comments.length?((0,r.uX)(),(0,r.CE)("div",Da,t[15]||(t[15]=[(0,r.Lk)("p",{class:"text-muted"},"No comments yet. Be the first to comment!",-1)]))):((0,r.uX)(),(0,r.CE)("div",Aa,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.comments,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"comment mb-3"},[(0,r.Lk)("div",Sa,[(0,r.bF)(i,{username:e.user.username,profilePicture:e.user.profile_picture,size:"sm",class:"me-2",backgroundColor:"bg-secondary"},null,8,["username","profilePicture"]),(0,r.Lk)("div",$a,[(0,r.Lk)("div",Ka,[(0,r.Lk)("div",Va,[(0,r.bF)(d,{to:`/profile/${e.user.username}`,class:"text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.Lk)("strong",null,(0,c.v_)(e.user.username),1)])),_:2},1032,["to"]),(0,r.Lk)("small",Ta,(0,c.v_)(l.formatDate(e.created_at)),1)]),(0,r.Lk)("p",qa,(0,c.v_)(e.content),1)])])])])))),128))]))])])])):((0,r.uX)(),(0,r.CE)("div",ia," Post not found or has been deleted. "))}var Qa={name:"PostDetail",components:{UserAvatar:yt},setup(){const e=(0,i.Pj)(),t=(0,L.lq)(),s=(0,L.rd)(),a=parseInt(t.params.id),l=(0,y.KR)(!0),o=(0,y.KR)(!0),n=(0,y.KR)(!1),c=(0,y.KR)(""),d=(0,r.EW)((()=>e.getters["auth/currentUser"]||{})),u=(0,r.EW)((()=>e.getters["posts/getCurrentPost"])),m=(0,r.EW)((()=>e.getters["comments/getCommentsByPostId"](a)||[])),p=(0,r.EW)((()=>d.value.id===u.value?.owner_id)),f=(0,r.EW)((()=>{if(!u.value?.created_at)return"";const e=new Date(u.value.created_at);return e.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})),v=e=>{const t=new Date(e);return t.toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},g=async()=>{l.value=!0;try{await e.dispatch("posts/fetchPostById",a)}finally{l.value=!1}},k=async()=>{o.value=!0;try{await e.dispatch("comments/fetchComments",a)}finally{o.value=!1}},b=async()=>{await e.dispatch("posts/votePost",a)},h=async()=>{if(c.value.trim()){n.value=!0;try{await e.dispatch("comments/createComment",{postId:a,content:c.value}),c.value=""}finally{n.value=!1}}},w=async()=>{if(confirm("Are you sure you want to delete this post?")){const t=await e.dispatch("posts/deletePost",a);t&&s.push("/")}};return(0,r.sV)((async()=>{await g(),await k()})),{post:u,loading:l,commentsLoading:o,commentLoading:n,comments:m,newComment:c,currentUser:d,isOwner:p,formattedDate:f,formatDate:v,vote:b,addComment:h,confirmDelete:w}}};const ja=(0,_.A)(Qa,[["render",Ba],["__scopeId","data-v-1c779337"]]);var Oa=ja;const Na={class:"row justify-content-center"},Ma={class:"col-lg-8"},za={class:"card shadow"},Ja={class:"card-body"},Ga={key:0,class:"alert alert-danger"},Ha={class:"mb-3"},Ya=["disabled"],Za={class:"mb-3"},er=["disabled"],tr={class:"mb-3 form-check"},sr=["disabled"],ar={class:"d-flex justify-content-between"},rr=["disabled"],lr={key:0,class:"spinner-border spinner-border-sm me-2"};function or(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Na,[(0,r.Lk)("div",Ma,[(0,r.Lk)("div",za,[t[9]||(t[9]=(0,r.Lk)("div",{class:"card-header bg-white"},[(0,r.Lk)("h5",{class:"mb-0"},"Create New Post")],-1)),(0,r.Lk)("div",Ja,[l.error?((0,r.uX)(),(0,r.CE)("div",Ga,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))},[(0,r.Lk)("div",Ha,[t[4]||(t[4]=(0,r.Lk)("label",{for:"title",class:"form-label"},"Title",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>l.formData.title=e),required:"",disabled:l.loading,placeholder:"Enter a title for your post"},null,8,Ya),[[a.Jo,l.formData.title]])]),(0,r.Lk)("div",Za,[t[5]||(t[5]=(0,r.Lk)("label",{for:"content",class:"form-label"},"Content",-1)),(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",id:"content","onUpdate:modelValue":t[1]||(t[1]=e=>l.formData.content=e),rows:"8",required:"",disabled:l.loading,placeholder:"Write your post content here..."},null,8,er),[[a.Jo,l.formData.content]])]),(0,r.Lk)("div",tr,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox",class:"form-check-input",id:"published","onUpdate:modelValue":t[2]||(t[2]=e=>l.formData.published=e),disabled:l.loading},null,8,sr),[[a.lH,l.formData.published]]),t[6]||(t[6]=(0,r.Lk)("label",{class:"form-check-label",for:"published"},"Publish this post",-1))]),(0,r.Lk)("div",ar,[(0,r.bF)(i,{to:"/",class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[7]||(t[7]=[(0,r.eW)(" Cancel ")]))),_:1}),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:l.loading||!l.isFormValid},[l.loading?((0,r.uX)(),(0,r.CE)("span",lr)):(0,r.Q3)("",!0),t[8]||(t[8]=(0,r.eW)(" Create Post "))],8,rr)])],32)])])])])}var nr={name:"CreatePost",setup(){const e=(0,i.Pj)(),t=(0,L.rd)(),s=(0,y.Kh)({title:"",content:"",published:!0}),a=(0,y.KR)(""),l=(0,y.KR)(!1),o=(0,r.EW)((()=>s.title.trim()&&s.content.trim())),n=async()=>{if(o.value){l.value=!0,a.value="";try{const r=await e.dispatch("posts/createPost",s);r?t.push(`/posts/${r.id}`):a.value="Failed to create post. Please try again."}catch(r){a.value=r.response?.data?.detail||"Failed to create post"}finally{l.value=!1}}};return{formData:s,error:a,loading:l,isFormValid:o,handleSubmit:n}}};const ir=(0,_.A)(nr,[["render",or]]);var cr=ir;const dr={class:"row justify-content-center"},ur={class:"col-lg-8"},mr={key:0,class:"text-center my-5"},pr={key:1,class:"alert alert-warning"},fr={key:2,class:"card shadow"},vr={class:"card-body"},gr={key:0,class:"alert alert-danger"},kr={class:"mb-3"},br=["disabled"],hr={class:"mb-3"},yr=["disabled"],Lr={class:"mb-3 form-check"},wr=["disabled"],_r={class:"d-flex justify-content-between"},Cr=["disabled"],Er={key:0,class:"spinner-border spinner-border-sm me-2"};function Pr(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",dr,[(0,r.Lk)("div",ur,[l.loading?((0,r.uX)(),(0,r.CE)("div",mr,t[4]||(t[4]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Loading post...",-1)]))):l.post?((0,r.uX)(),(0,r.CE)("div",fr,[t[10]||(t[10]=(0,r.Lk)("div",{class:"card-header bg-white"},[(0,r.Lk)("h5",{class:"mb-0"},"Edit Post")],-1)),(0,r.Lk)("div",vr,[l.error?((0,r.uX)(),(0,r.CE)("div",gr,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),(0,r.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))},[(0,r.Lk)("div",kr,[t[5]||(t[5]=(0,r.Lk)("label",{for:"title",class:"form-label"},"Title",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>l.formData.title=e),required:"",disabled:l.saving},null,8,br),[[a.Jo,l.formData.title]])]),(0,r.Lk)("div",hr,[t[6]||(t[6]=(0,r.Lk)("label",{for:"content",class:"form-label"},"Content",-1)),(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",id:"content","onUpdate:modelValue":t[1]||(t[1]=e=>l.formData.content=e),rows:"8",required:"",disabled:l.saving},null,8,yr),[[a.Jo,l.formData.content]])]),(0,r.Lk)("div",Lr,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox",class:"form-check-input",id:"published","onUpdate:modelValue":t[2]||(t[2]=e=>l.formData.published=e),disabled:l.saving},null,8,wr),[[a.lH,l.formData.published]]),t[7]||(t[7]=(0,r.Lk)("label",{class:"form-check-label",for:"published"},"Published",-1))]),(0,r.Lk)("div",_r,[(0,r.bF)(i,{to:`/posts/${l.postId}`,class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[8]||(t[8]=[(0,r.eW)(" Cancel ")]))),_:1},8,["to"]),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:l.saving||!l.isFormValid},[l.saving?((0,r.uX)(),(0,r.CE)("span",Er)):(0,r.Q3)("",!0),t[9]||(t[9]=(0,r.eW)(" Save Changes "))],8,Cr)])],32)])])):((0,r.uX)(),(0,r.CE)("div",pr," Post not found or has been deleted. "))])])}var Rr={name:"EditPost",setup(){const e=(0,i.Pj)(),t=(0,L.lq)(),s=(0,L.rd)(),a=parseInt(t.params.id),l=(0,y.KR)(!0),o=(0,y.KR)(!1),n=(0,y.KR)(""),c=(0,y.Kh)({title:"",content:"",published:!0}),d=(0,r.EW)((()=>e.getters["posts/getCurrentPost"])),u=(0,r.EW)((()=>c.title.trim()&&c.content.trim()));(0,r.wB)(d,(e=>{e&&(c.title=e.title,c.content=e.content,c.published=e.published)}));const m=async()=>{l.value=!0;try{await e.dispatch("posts/fetchPostById",a);const t=e.getters["auth/currentUser"];d.value&&d.value.owner_id!==t.id&&s.push(`/posts/${a}`)}finally{l.value=!1}},p=async()=>{if(u.value){o.value=!0,n.value="";try{const t=await e.dispatch("posts/updatePost",{id:a,postData:{title:c.title,content:c.content,published:c.published}});t?s.push(`/posts/${a}`):n.value="Failed to update post. Please try again."}catch(t){n.value=t.response?.data?.detail||"Failed to update post"}finally{o.value=!1}}};return(0,r.sV)(m),{post:d,postId:a,formData:c,loading:l,saving:o,error:n,isFormValid:u,handleSubmit:p}}};const Fr=(0,_.A)(Rr,[["render",Pr]]);var Ur=Fr;const xr={class:"not-found text-center py-5"},Ir={class:"container"};function Wr(e,t,s,a,l,o){const n=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",xr,[(0,r.Lk)("div",Ir,[t[1]||(t[1]=(0,r.Lk)("i",{class:"fas fa-search fa-4x text-muted mb-4"},null,-1)),t[2]||(t[2]=(0,r.Lk)("h1",{class:"display-4"},"Page Not Found",-1)),t[3]||(t[3]=(0,r.Lk)("p",{class:"lead"},"The page you're looking for doesn't exist or has been moved.",-1)),(0,r.bF)(n,{to:"/",class:"btn btn-primary btn-lg mt-3"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.Lk)("i",{class:"fas fa-home me-2"},null,-1),(0,r.eW)(" Go Home ")]))),_:1})])])}var Xr={name:"NotFound"};const Dr=(0,_.A)(Xr,[["render",Wr]]);var Ar=Dr;const Sr={class:"reels-page"},$r={class:"container"},Kr={class:"d-flex justify-content-between align-items-center mb-4"};function Vr(e,t,s,a,l,o){const n=(0,r.g2)("router-link"),i=(0,r.g2)("ReelsFeed");return(0,r.uX)(),(0,r.CE)("div",Sr,[(0,r.Lk)("div",$r,[(0,r.Lk)("div",Kr,[t[1]||(t[1]=(0,r.Lk)("h1",null,"Reels",-1)),(0,r.bF)(n,{to:"/create-reel",class:"btn btn-primary"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.Lk)("i",{class:"fas fa-plus me-2"},null,-1),(0,r.eW)(" Create Reel ")]))),_:1})]),(0,r.bF)(i)])])}const Tr={class:"reels-container"},qr={key:0,class:"text-center my-4"},Br={key:1,class:"text-center my-4"},Qr={class:"alert alert-info"},jr={class:"mt-2"},Or={key:2,class:"row g-4"},Nr={class:"card reel-card h-100"},Mr=["onClick"],zr={key:0,class:"video-error-container"},Jr={key:0,class:"text-muted mt-2"},Gr=["src","onError"],Hr={class:"card-body"},Yr={class:"card-title"},Zr={class:"card-text small text-muted"},el={class:"card-text"},tl={class:"card-footer bg-transparent"},sl={class:"d-flex justify-content-between align-items-center"},al={class:"me-3"},rl={key:0},ll=["onClick"],ol={key:3,class:"text-center mt-4"},nl=["disabled"],il={class:"modal fade",id:"deleteReelModal",tabindex:"-1","aria-hidden":"true"},cl={class:"modal-dialog"},dl={class:"modal-content"},ul={class:"modal-footer"};function ml(e,t,s,a,l,o){const n=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Tr,[a.loading?((0,r.uX)(),(0,r.CE)("div",qr,t[2]||(t[2]=[(0,r.Lk)("i",{class:"fas fa-spinner fa-spin fa-2x"},null,-1),(0,r.Lk)("p",null,"Loading reels...",-1)]))):0===a.reels.length?((0,r.uX)(),(0,r.CE)("div",Br,[(0,r.Lk)("div",Qr,[t[4]||(t[4]=(0,r.Lk)("i",{class:"fas fa-film me-2"},null,-1)),t[5]||(t[5]=(0,r.eW)(" No reels found. ")),(0,r.Lk)("div",jr,[(0,r.bF)(n,{to:"/create-reel",class:"btn btn-primary btn-sm"},{default:(0,r.k6)((()=>t[3]||(t[3]=[(0,r.Lk)("i",{class:"fas fa-plus me-2"},null,-1),(0,r.eW)(" Create your first reel ")]))),_:1})])])])):((0,r.uX)(),(0,r.CE)("div",Or,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(a.reels,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"col-md-6 col-lg-4"},[(0,r.Lk)("div",Nr,[(0,r.Lk)("div",{class:"reel-preview",onClick:t=>a.viewReel(e.id)},[a.videoLoadErrors[e.id]?((0,r.uX)(),(0,r.CE)("div",zr,[t[6]||(t[6]=(0,r.Lk)("i",{class:"fas fa-exclamation-triangle fa-2x mb-2"},null,-1)),t[7]||(t[7]=(0,r.Lk)("p",null,"Unable to load video",-1)),e.video_url?((0,r.uX)(),(0,r.CE)("small",Jr," URL: "+(0,c.v_)(e.video_url),1)):(0,r.Q3)("",!0)])):((0,r.uX)(),(0,r.CE)("video",{key:1,class:"card-img-top",src:a.getVideoUrl(e.video_url),preload:"metadata",muted:"",onError:t=>a.handleVideoError(t,e)},null,40,Gr)),t[8]||(t[8]=(0,r.Lk)("div",{class:"overlay"},[(0,r.Lk)("i",{class:"fas fa-play-circle fa-3x"})],-1))],8,Mr),(0,r.Lk)("div",Hr,[(0,r.Lk)("h5",Yr,(0,c.v_)(e.title||"Untitled Reel"),1),(0,r.Lk)("p",Zr,[t[9]||(t[9]=(0,r.eW)(" By ")),(0,r.bF)(n,{to:`/profile/${e?.owner?.username||"unknown"}`},{default:(0,r.k6)((()=>[(0,r.eW)((0,c.v_)(e?.owner?.username||"Unknown user"),1)])),_:2},1032,["to"]),(0,r.eW)(" Â· "+(0,c.v_)(a.formatDate(e.created_at)),1)]),(0,r.Lk)("p",el,(0,c.v_)(a.truncateText(e.description,80)),1)]),(0,r.Lk)("div",tl,[(0,r.Lk)("div",sl,[(0,r.Lk)("div",null,[(0,r.Lk)("span",al,[(0,r.Lk)("i",{class:(0,c.C4)(["fas fa-heart",{"text-danger":e.is_liked}])},null,2),(0,r.eW)(" "+(0,c.v_)(e.likes||0),1)]),(0,r.Lk)("span",null,[t[10]||(t[10]=(0,r.Lk)("i",{class:"fas fa-comment"},null,-1)),(0,r.eW)(" "+(0,c.v_)(e.comments_count||0),1)])]),a.currentUser&&a.currentUser.id===e.owner_id?((0,r.uX)(),(0,r.CE)("div",rl,[(0,r.bF)(n,{to:`/edit-reel/${e.id}`,class:"btn btn-sm btn-outline-secondary me-2"},{default:(0,r.k6)((()=>t[11]||(t[11]=[(0,r.Lk)("i",{class:"fas fa-edit"},null,-1)]))),_:2},1032,["to"]),(0,r.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:t=>a.deleteReelConfirm(e)},t[12]||(t[12]=[(0,r.Lk)("i",{class:"fas fa-trash"},null,-1)]),8,ll)])):(0,r.Q3)("",!0)])])])])))),128))])),a.reels.length>0&&!a.reachedEnd?((0,r.uX)(),(0,r.CE)("div",ol,[(0,r.Lk)("button",{class:"btn btn-outline-primary",onClick:t[0]||(t[0]=(...e)=>a.loadMore&&a.loadMore(...e)),disabled:a.loading},[(0,r.Lk)("i",{class:(0,c.C4)(["fas fa-sync me-2",{"fa-spin":a.loading}])},null,2),t[13]||(t[13]=(0,r.eW)(" Load more reels "))],8,nl)])):(0,r.Q3)("",!0),(0,r.Lk)("div",il,[(0,r.Lk)("div",cl,[(0,r.Lk)("div",dl,[t[15]||(t[15]=(0,r.Lk)("div",{class:"modal-header"},[(0,r.Lk)("h5",{class:"modal-title"},"Delete Reel"),(0,r.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t[16]||(t[16]=(0,r.Lk)("div",{class:"modal-body"}," Are you sure you want to delete this reel? This action cannot be undone. ",-1)),(0,r.Lk)("div",ul,[t[14]||(t[14]=(0,r.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[1]||(t[1]=(...e)=>a.confirmDelete&&a.confirmDelete(...e))},"Delete")])])])])])}var pl=s(8077),fl={name:"ReelsFeed",props:{userId:{type:Number,default:null}},setup(e){const t=(0,i.Pj)(),s=(0,L.rd)(),a=(0,y.KR)(!1),l=(0,y.KR)(0),o=(0,y.KR)(9),n=(0,y.KR)(!1),c=(0,y.KR)(null),d=(0,y.KR)(null),u=(0,y.KR)({}),m=(0,r.EW)((()=>t.getters["reels/allReels"]||[])),p=(0,r.EW)((()=>t.getters["auth/currentUser"])),f=async(s=!1)=>{if(!a.value){a.value=!0,s||(l.value=0,n.value=!1,u.value={});try{console.log(`Fetching reels with params: limit=${o.value}, skip=${l.value}, userId=${e.userId}`);const a=await t.dispatch("reels/fetchReels",{limit:o.value,skip:l.value,userId:e.userId});console.log(`Fetched ${a?.length||0} reels`),a?.length<o.value&&(n.value=!0),s&&(l.value+=o.value)}catch(r){console.error("Error fetching reels:",r)}finally{a.value=!1}}},v=e=>{if(!e)return"";const t=(void 0).VITE_API_URL||"https://social-media-platform-jgf2.onrender.com";if(e.startsWith("/"))return`${t}${e}`;if(e.includes("localhost")){const s=new URL(e);return`${t}${s.pathname}`}return e},g=()=>{f(!0)},k=e=>{e&&s.push(`/reels/${e}`)},b=e=>{if(e){if(d.value=e,!c.value){const e=document.getElementById("deleteReelModal");e&&(c.value=new pl.aF(e))}c.value&&c.value.show()}},h=async()=>{if(d.value)try{const e=await t.dispatch("reels/deleteReel",d.value.id);e&&(c.value&&c.value.hide(),f())}catch(e){console.error("Error deleting reel:",e)}},w=e=>{if(!e)return"Unknown date";try{const t=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t)}catch(t){return console.error("Error formatting date:",t),"Invalid date"}},_=(e,t)=>e?e.length>t?e.substring(0,t)+"...":e:"",C=(e,t)=>{t&&t.id&&(console.error(`Error loading video for reel ${t.id}:`,e,"URL:",t.video_url),e.target&&e.target.classList.add("video-error"),u.value[t.id]=!0)};return(0,r.sV)((()=>{f();const e=document.getElementById("deleteReelModal");e&&(c.value=new pl.aF(e))})),(0,r.wB)((()=>e.userId),(()=>{f()})),{reels:m,loading:a,reachedEnd:n,currentUser:p,deleteModal:c,reelToDelete:d,videoLoadErrors:u,loadMore:g,viewReel:k,deleteReelConfirm:b,confirmDelete:h,formatDate:w,truncateText:_,handleVideoError:C,getVideoUrl:v}}};const vl=(0,_.A)(fl,[["render",ml],["__scopeId","data-v-4388be5d"]]);var gl=vl,kl={name:"ReelsView",components:{ReelsFeed:gl}};const bl=(0,_.A)(kl,[["render",Vr],["__scopeId","data-v-57dcbd48"]]);var hl=bl;const yl={class:"reel-detail-view"},Ll={class:"container"},wl={class:"mb-4"};function _l(e,t,s,a,l,o){const n=(0,r.g2)("router-link"),i=(0,r.g2)("ReelDetail");return(0,r.uX)(),(0,r.CE)("div",yl,[(0,r.Lk)("div",Ll,[(0,r.Lk)("div",wl,[(0,r.bF)(n,{to:"/reels",class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.Lk)("i",{class:"fas fa-arrow-left me-2"},null,-1),(0,r.eW)(" Back to Reels ")]))),_:1})]),(0,r.bF)(i)])])}const Cl={class:"reel-detail-container"},El={key:0,class:"text-center my-5"},Pl={key:1,class:"alert alert-danger"},Rl={key:2,class:"reel-content"},Fl={class:"row"},Ul={class:"col-md-8"},xl={class:"video-player-container"},Il=["src","type"],Wl={key:0,class:"video-error-message"},Xl={key:0,class:"mt-2"},Dl={class:"reel-info mt-3"},Al={class:"d-flex align-items-center my-3"},Sl={class:"avatar"},$l={class:"ms-2 fw-bold"},Kl={class:"text-muted"},Vl={key:0,class:"ms-auto"},Tl={class:"dropdown"},ql={class:"dropdown-menu","aria-labelledby":"reelActionsDropdown"},Bl={class:"reel-actions d-flex align-items-center my-3"},Ql={class:"ms-1"},jl={class:"ms-1"},Ol={class:"reel-description"},Nl={key:0,class:"video-details mt-3 p-3 bg-light rounded"},Ml={key:0,class:"small text-muted mt-2"},zl={class:"col-md-4"},Jl={class:"comments-container"},Gl={key:0,class:"text-center my-3"},Hl={key:1,class:"text-center my-3"},Yl={key:2,class:"comments-list"},Zl={class:"d-flex"},eo={class:"comment-avatar"},to={class:"comment-content ms-2"},so={class:"comment-header"},ao={class:"text-muted ms-2"},ro={class:"comment-text"},lo={class:"comment-form mt-3"},oo={class:"input-group"},no=["disabled"],io=["disabled"],co={key:0,class:"form-text text-center mt-2"},uo={class:"modal fade",id:"deleteReelModal",tabindex:"-1","aria-hidden":"true",ref:"deleteModal"},mo={class:"modal-dialog"},po={class:"modal-content"},fo={class:"modal-footer"};function vo(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Cl,[l.loading?((0,r.uX)(),(0,r.CE)("div",El,t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-spinner fa-spin fa-3x"},null,-1),(0,r.Lk)("p",{class:"mt-3"},"Loading reel...",-1)]))):l.reel?((0,r.uX)(),(0,r.CE)("div",Rl,[(0,r.Lk)("div",Fl,[(0,r.Lk)("div",Ul,[(0,r.Lk)("div",xl,[(0,r.Lk)("video",{controls:"",autoplay:"",class:"video-player",ref:"videoPlayer",onError:t[0]||(t[0]=(...e)=>l.handleVideoError&&l.handleVideoError(...e))},[(0,r.Lk)("source",{src:l.reel.video_url,type:l.getVideoType(l.reel.video_url)},null,8,Il),t[8]||(t[8]=(0,r.eW)(" Your browser does not support the video tag. "))],544),l.videoError?((0,r.uX)(),(0,r.CE)("div",Wl,[t[10]||(t[10]=(0,r.Lk)("i",{class:"fas fa-exclamation-triangle fa-2x mb-2"},null,-1)),t[11]||(t[11]=(0,r.Lk)("p",null,"Unable to play this video. It may be unavailable or in an unsupported format.",-1)),l.isOwner?((0,r.uX)(),(0,r.CE)("p",Xl,[(0,r.bF)(i,{to:`/edit-reel/${l.reel.id}`,class:"btn btn-sm btn-primary"},{default:(0,r.k6)((()=>t[9]||(t[9]=[(0,r.Lk)("i",{class:"fas fa-edit me-1"},null,-1),(0,r.eW)(" Edit this reel ")]))),_:1},8,["to"])])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Dl,[(0,r.Lk)("h2",null,(0,c.v_)(l.reel.title),1),(0,r.Lk)("div",Al,[(0,r.bF)(i,{to:`/profile/${l.reel.owner.username}`,class:"d-flex align-items-center text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.Lk)("span",Sl,(0,c.v_)(l.getUserInitial(l.reel.owner.username)),1),(0,r.Lk)("span",$l,(0,c.v_)(l.reel.owner.username),1)])),_:1},8,["to"]),t[15]||(t[15]=(0,r.Lk)("span",{class:"mx-3"},"â¢",-1)),(0,r.Lk)("span",Kl,(0,c.v_)(l.formatDate(l.reel.created_at)),1),l.isOwner?((0,r.uX)(),(0,r.CE)("div",Vl,[(0,r.Lk)("div",Tl,[t[14]||(t[14]=(0,r.Lk)("button",{class:"btn btn-sm btn-outline-secondary",type:"button",id:"reelActionsDropdown","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,r.Lk)("i",{class:"fas fa-ellipsis-h"})],-1)),(0,r.Lk)("ul",ql,[(0,r.Lk)("li",null,[(0,r.bF)(i,{to:`/edit-reel/${l.reel.id}`,class:"dropdown-item"},{default:(0,r.k6)((()=>t[12]||(t[12]=[(0,r.Lk)("i",{class:"fas fa-edit me-2"},null,-1),(0,r.eW)(" Edit ")]))),_:1},8,["to"])]),(0,r.Lk)("li",null,[(0,r.Lk)("button",{class:"dropdown-item text-danger",onClick:t[1]||(t[1]=(...e)=>l.confirmDelete&&l.confirmDelete(...e))},t[13]||(t[13]=[(0,r.Lk)("i",{class:"fas fa-trash me-2"},null,-1),(0,r.eW)(" Delete ")]))])])])])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",Bl,[(0,r.Lk)("button",{class:(0,c.C4)(["btn btn-like me-3",{liked:l.reel.is_liked}]),onClick:t[2]||(t[2]=(...e)=>l.handleLike&&l.handleLike(...e))},[t[16]||(t[16]=(0,r.Lk)("i",{class:"fas fa-heart"},null,-1)),(0,r.Lk)("span",Ql,(0,c.v_)(l.reel.likes),1)],2),(0,r.Lk)("button",{class:"btn btn-comment",onClick:t[3]||(t[3]=(...e)=>l.focusCommentInput&&l.focusCommentInput(...e))},[t[17]||(t[17]=(0,r.Lk)("i",{class:"fas fa-comment"},null,-1)),(0,r.Lk)("span",jl,(0,c.v_)(l.comments.length),1)])]),(0,r.Lk)("div",Ol,[(0,r.Lk)("p",null,(0,c.v_)(l.reel.description),1)]),l.isOwner?((0,r.uX)(),(0,r.CE)("div",Nl,[t[19]||(t[19]=(0,r.Lk)("h6",null,[(0,r.Lk)("i",{class:"fas fa-info-circle me-2"}),(0,r.eW)(" Video Details")],-1)),l.reel.video_url?((0,r.uX)(),(0,r.CE)("div",Ml,[(0,r.Lk)("div",null,[t[18]||(t[18]=(0,r.Lk)("strong",null,"URL:",-1)),(0,r.eW)(" "+(0,c.v_)(l.reel.video_url),1)])])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",zl,[(0,r.Lk)("div",Jl,[t[25]||(t[25]=(0,r.Lk)("h4",{class:"mb-3"},"Comments",-1)),l.commentsLoading?((0,r.uX)(),(0,r.CE)("div",Gl,t[20]||(t[20]=[(0,r.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1),(0,r.Lk)("p",null,"Loading comments...",-1)]))):0===l.comments.length?((0,r.uX)(),(0,r.CE)("div",Hl,t[21]||(t[21]=[(0,r.Lk)("p",{class:"text-muted"},"No comments yet.",-1),(0,r.Lk)("p",null,"Be the first to comment!",-1)]))):((0,r.uX)(),(0,r.CE)("div",Yl,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.comments,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"comment-item"},[(0,r.Lk)("div",Zl,[(0,r.Lk)("div",eo,(0,c.v_)(l.getUserInitial(e.user.username)),1),(0,r.Lk)("div",to,[(0,r.Lk)("div",so,[(0,r.bF)(i,{to:`/profile/${e.user.username}`,class:"fw-bold text-decoration-none"},{default:(0,r.k6)((()=>[(0,r.eW)((0,c.v_)(e.user.username),1)])),_:2},1032,["to"]),(0,r.Lk)("small",ao,(0,c.v_)(l.formatDate(e.created_at)),1)]),(0,r.Lk)("div",ro,(0,c.v_)(e.content),1)])])])))),128))])),(0,r.Lk)("div",lo,[(0,r.Lk)("form",{onSubmit:t[5]||(t[5]=(0,a.D$)(((...e)=>l.submitComment&&l.submitComment(...e)),["prevent"]))},[(0,r.Lk)("div",oo,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",placeholder:"Add a comment...","onUpdate:modelValue":t[4]||(t[4]=e=>l.commentText=e),ref:"commentInput",disabled:!l.isAuthenticated},null,8,no),[[a.Jo,l.commentText]]),(0,r.Lk)("button",{class:"btn btn-primary",type:"submit",disabled:!l.commentText.trim()||!l.isAuthenticated},t[22]||(t[22]=[(0,r.Lk)("i",{class:"fas fa-paper-plane"},null,-1)]),8,io)]),l.isAuthenticated?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",co,[(0,r.bF)(i,{to:"/login"},{default:(0,r.k6)((()=>t[23]||(t[23]=[(0,r.eW)("Log in")]))),_:1}),t[24]||(t[24]=(0,r.eW)(" to leave a comment. "))]))],32)])])])])])):((0,r.uX)(),(0,r.CE)("div",Pl," Reel not found or has been deleted. ")),(0,r.Lk)("div",uo,[(0,r.Lk)("div",mo,[(0,r.Lk)("div",po,[t[27]||(t[27]=(0,r.Lk)("div",{class:"modal-header"},[(0,r.Lk)("h5",{class:"modal-title"},"Delete Reel"),(0,r.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t[28]||(t[28]=(0,r.Lk)("div",{class:"modal-body"}," Are you sure you want to delete this reel? This action cannot be undone. ",-1)),(0,r.Lk)("div",fo,[t[26]||(t[26]=(0,r.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),(0,r.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[6]||(t[6]=(...e)=>l.deleteReel&&l.deleteReel(...e))},"Delete")])])])],512)])}var go={name:"ReelDetail",setup(){const e=(0,i.Pj)(),t=(0,L.lq)(),s=(0,L.rd)(),a=(0,y.KR)(null),l=(0,y.KR)(null),o=(0,y.KR)(null),n=(0,y.KR)(!0),c=(0,y.KR)(!1),d=(0,y.KR)(""),u=(0,y.KR)(!1),m=(0,r.EW)((()=>e.getters["reels/getCurrentReel"])),p=(0,r.EW)((()=>e.getters["reels/getReelComments"](Number(t.params.id)))),f=(0,r.EW)((()=>e.getters["auth/currentUser"])),v=(0,r.EW)((()=>e.getters["auth/isAuthenticated"])),g=(0,r.EW)((()=>!(!m.value||!f.value)&&m.value.owner_id===f.value.id)),k=(0,r.EW)((()=>Number(t.params.id))),b=async()=>{n.value=!0,u.value=!1;try{await e.dispatch("reels/fetchReelById",k.value),await h()}catch(t){console.error("Failed to load reel:",t)}finally{n.value=!1}},h=async()=>{c.value=!0;try{await e.dispatch("reels/fetchReelComments",k.value)}catch(t){console.error("Failed to load comments:",t)}finally{c.value=!1}},w=async()=>{v.value?await e.dispatch("reels/likeReel",k.value):s.push("/login")},_=async()=>{if(d.value.trim()&&v.value)try{await e.dispatch("reels/commentOnReel",{reelId:k.value,content:d.value.trim()}),d.value=""}catch(t){console.error("Failed to post comment:",t)}},C=()=>{l.value&&l.value.focus()},E=()=>{o.value||(o.value=new pl.aF(document.getElementById("deleteReelModal"))),o.value.show()},P=async()=>{try{const t=await e.dispatch("reels/deleteReel",k.value);t&&(o.value&&o.value.hide(),s.push("/reels"))}catch(t){console.error("Failed to delete reel:",t)}},R=e=>{if(!e)return"Unknown date";try{const t=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}catch(t){return console.error("Error formatting date:",t),"Invalid date"}},F=e=>e?e.charAt(0).toUpperCase():"?",U=e=>{if(!e)return"video/mp4";const t=e.split(".").pop().toLowerCase();switch(t){case"mp4":return"video/mp4";case"webm":return"video/webm";case"mov":return"video/quicktime";case"ogg":return"video/ogg";default:return"video/mp4"}},x=e=>{console.error("Video error:",e),u.value=!0};return(0,r.wB)((()=>t.params.id),(e=>{e&&Number(e)!==k.value&&(u.value=!1,b())})),(0,r.sV)((()=>{b()})),(0,r.hi)((()=>{a.value&&a.value.pause()})),{reel:m,loading:n,commentsLoading:c,comments:p,commentText:d,videoPlayer:a,commentInput:l,isAuthenticated:v,isOwner:g,videoError:u,loadReelData:b,handleLike:w,submitComment:_,focusCommentInput:C,confirmDelete:E,deleteReel:P,formatDate:R,getUserInitial:F,getVideoType:U,handleVideoError:x}}};const ko=(0,_.A)(go,[["render",vo],["__scopeId","data-v-0b53a6c9"]]);var bo=ko,ho={name:"ReelDetailView",components:{ReelDetail:bo}};const yo=(0,_.A)(ho,[["render",_l],["__scopeId","data-v-6906c41a"]]);var Lo=yo;const wo={class:"create-reel-view"},_o={class:"container"},Co={class:"mb-4"};function Eo(e,t,s,a,l,o){const n=(0,r.g2)("router-link"),i=(0,r.g2)("CreateReel");return(0,r.uX)(),(0,r.CE)("div",wo,[(0,r.Lk)("div",_o,[(0,r.Lk)("div",Co,[(0,r.bF)(n,{to:"/reels",class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.Lk)("i",{class:"fas fa-arrow-left me-2"},null,-1),(0,r.eW)(" Back to Reels ")]))),_:1})]),(0,r.bF)(i)])])}const Po={class:"create-reel-container"},Ro={class:"card shadow-sm"},Fo={class:"card-header bg-primary text-white"},Uo={class:"m-0"},xo={class:"card-body"},Io={class:"mb-3"},Wo={class:"mb-3"},Xo={class:"mb-3"},Do={class:"input-group"},Ao=["required"],So={key:0,class:"mt-2"},$o={class:"d-flex align-items-center"},Ko={class:"text-muted"},Vo={key:0,class:"video-preview-container mb-3"},To={class:"video-preview"},qo={ref:"videoPreviewElement",controls:"",class:"preview-video"},Bo=["src","type"],Qo={key:1,class:"alert alert-danger"},jo={key:2,class:"mb-3"},Oo={class:"progress"},No=["aria-valuenow"],Mo={class:"d-flex justify-content-between mt-4"},zo=["disabled"],Jo={key:0,class:"spinner-border spinner-border-sm me-2",role:"status"};function Go(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Po,[(0,r.Lk)("div",Ro,[(0,r.Lk)("div",Fo,[(0,r.Lk)("h4",Uo,(0,c.v_)(l.isEditing?"Edit Reel":"Create New Reel"),1)]),(0,r.Lk)("div",xo,[(0,r.Lk)("form",{onSubmit:t[4]||(t[4]=(0,a.D$)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"]))},[(0,r.Lk)("div",Io,[t[5]||(t[5]=(0,r.Lk)("label",{for:"title",class:"form-label"},"Title",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>l.form.title=e),required:"",placeholder:"Enter a title for your reel"},null,512),[[a.Jo,l.form.title]])]),(0,r.Lk)("div",Wo,[t[6]||(t[6]=(0,r.Lk)("label",{for:"description",class:"form-label"},"Description",-1)),(0,r.bo)((0,r.Lk)("textarea",{class:"form-control",id:"description","onUpdate:modelValue":t[1]||(t[1]=e=>l.form.description=e),rows:"3",placeholder:"Add a description to your reel"},null,512),[[a.Jo,l.form.description]])]),(0,r.Lk)("div",Xo,[t[8]||(t[8]=(0,r.Lk)("label",{for:"videoFile",class:"form-label"},"Video File",-1)),(0,r.Lk)("div",Do,[(0,r.Lk)("input",{type:"file",class:"form-control",id:"videoFile",onChange:t[2]||(t[2]=(...e)=>l.handleFileChange&&l.handleFileChange(...e)),required:!l.isEditing,accept:"video/*",ref:"fileInput"},null,40,Ao),l.form.videoFile?((0,r.uX)(),(0,r.CE)("button",{key:0,type:"button",class:"btn btn-outline-secondary",onClick:t[3]||(t[3]=(...e)=>l.clearSelectedFile&&l.clearSelectedFile(...e))}," Clear ")):(0,r.Q3)("",!0)]),t[9]||(t[9]=(0,r.Lk)("div",{class:"form-text"}," Supported formats: MP4, WebM, MOV. Max size: 50MB. ",-1)),l.form.videoFile?((0,r.uX)(),(0,r.CE)("div",So,[(0,r.Lk)("div",$o,[t[7]||(t[7]=(0,r.Lk)("i",{class:"fas fa-check-circle text-success me-2"},null,-1)),(0,r.Lk)("div",null,[(0,r.Lk)("div",null,(0,c.v_)(l.form.videoFile.name),1),(0,r.Lk)("small",Ko,(0,c.v_)(l.formatFileSize(l.form.videoFile.size))+" - "+(0,c.v_)(l.form.videoFile.type),1)])])])):(0,r.Q3)("",!0)]),l.videoPreview?((0,r.uX)(),(0,r.CE)("div",Vo,[t[11]||(t[11]=(0,r.Lk)("h5",null,"Preview",-1)),(0,r.Lk)("div",To,[(0,r.Lk)("video",qo,[(0,r.Lk)("source",{src:l.videoPreview,type:l.videoMimeType},null,8,Bo),t[10]||(t[10]=(0,r.eW)(" Your browser does not support the video tag. "))],512)])])):(0,r.Q3)("",!0),l.error?((0,r.uX)(),(0,r.CE)("div",Qo,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),l.uploadProgress>0&&l.uploadProgress<100?((0,r.uX)(),(0,r.CE)("div",jo,[t[12]||(t[12]=(0,r.Lk)("label",{class:"form-label"},"Upload Progress",-1)),(0,r.Lk)("div",Oo,[(0,r.Lk)("div",{class:"progress-bar",role:"progressbar",style:(0,c.Tr)({width:l.uploadProgress+"%"}),"aria-valuenow":l.uploadProgress,"aria-valuemin":"0","aria-valuemax":"100"},(0,c.v_)(l.uploadProgress)+"% ",13,No)])])):(0,r.Q3)("",!0),(0,r.Lk)("div",Mo,[(0,r.bF)(i,{to:"/reels",class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[13]||(t[13]=[(0,r.eW)(" Cancel ")]))),_:1}),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:l.loading||l.uploadProgress>0},[l.loading?((0,r.uX)(),(0,r.CE)("span",Jo)):(0,r.Q3)("",!0),(0,r.eW)(" "+(0,c.v_)(l.isEditing?"Update Reel":"Upload Reel"),1)],8,zo)])],32)])])])}var Ho={name:"CreateReel",setup(){const e=(0,i.Pj)(),t=(0,L.rd)(),s=(0,L.lq)(),a=(0,y.KR)({title:"",description:"",videoFile:null}),l=(0,y.KR)(null),o=(0,y.KR)(null),n=(0,y.KR)("video/mp4"),c=(0,y.KR)(null),d=(0,y.KR)(!1),u=(0,y.KR)(null),m=(0,y.KR)(0),p=(0,r.EW)((()=>s.params.id?parseInt(s.params.id):null)),f=(0,r.EW)((()=>!!p.value)),v=async()=>{if(f.value){d.value=!0;try{const s=await e.dispatch("reels/fetchReelById",p.value);if(s){if(a.value.title=s.title,a.value.description=s.description,s.video_url){o.value=s.video_url;const e=s.video_url.split(".").pop().toLowerCase();"mp4"===e?n.value="video/mp4":"webm"===e?n.value="video/webm":"mov"===e&&(n.value="video/quicktime")}}else u.value="Reel not found",t.push("/reels")}catch(s){u.value="Failed to load reel data",console.error("Error loading reel:",s)}finally{d.value=!1}}},g=e=>{const t=e.target.files[0];if(!t)return void k();const s=52428800;if(t.size>s)return u.value="File size exceeds 50MB limit. Please choose a smaller file.",void(e.target.value="");const r=["video/mp4","video/webm","video/quicktime"];if(!r.includes(t.type))return u.value="Invalid file type. Please select MP4, WebM, or MOV video file.",void(e.target.value="");u.value=null,a.value.videoFile=t,n.value=t.type,console.log("Selected file:",{name:t.name,size:t.size,type:t.type});const l=new FileReader;l.onload=e=>{o.value=e.target.result},l.readAsDataURL(t)},k=()=>{a.value.videoFile=null,o.value=null,l.value&&(l.value.value=""),c.value&&(c.value.src=""),f.value&&v()},b=e=>{if(0===e)return"0 Bytes";const t=1024,s=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,a)).toFixed(2))+" "+s[a]},h=async()=>{if(a.value.title)if(f.value||a.value.videoFile){u.value=null,d.value=!0,m.value=0;try{let s;const r={onUploadProgress:e=>{const t=Math.round(100*e.loaded/e.total);m.value=t,console.log(`Upload progress: ${t}%`)}};if(f.value){if(s=await e.dispatch("reels/updateReel",{id:p.value,reelData:a.value,config:r}),!s)throw new Error("Failed to update reel");t.push(`/reels/${p.value}`)}else{if(s=await e.dispatch("reels/createReel",{...a.value,config:r}),!s)throw new Error("Failed to create reel");t.push(`/reels/${s.id}`)}}catch(s){console.error("Error submitting reel:",s),u.value=s.message||"An error occurred while saving the reel"}finally{d.value=!1,m.value=0}}else u.value="Video file is required";else u.value="Title is required"};return(0,r.sV)((()=>{f.value&&v()})),e.commit("reels/set_current_reel",null),{form:a,fileInput:l,videoPreview:o,videoMimeType:n,videoPreviewElement:c,loading:d,error:u,uploadProgress:m,isEditing:f,handleFileChange:g,clearSelectedFile:k,formatFileSize:b,submitForm:h}}};const Yo=(0,_.A)(Ho,[["render",Go],["__scopeId","data-v-00975b7d"]]);var Zo=Yo,en={name:"CreateReelView",components:{CreateReel:Zo}};const tn=(0,_.A)(en,[["render",Eo],["__scopeId","data-v-4b01248a"]]);var sn=tn;const an={class:"edit-reel-view"},rn={class:"container"},ln={class:"mb-4"};function on(e,t,s,a,l,o){const n=(0,r.g2)("router-link"),i=(0,r.g2)("CreateReel");return(0,r.uX)(),(0,r.CE)("div",an,[(0,r.Lk)("div",rn,[(0,r.Lk)("div",ln,[(0,r.bF)(n,{to:`/reels/${e.$route.params.id}`,class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[0]||(t[0]=[(0,r.Lk)("i",{class:"fas fa-arrow-left me-2"},null,-1),(0,r.eW)(" Back to Reel ")]))),_:1},8,["to"])]),(0,r.bF)(i)])])}var nn={name:"EditReelView",components:{CreateReel:Zo}};const cn=(0,_.A)(nn,[["render",on],["__scopeId","data-v-6b8a99bf"]]);var dn=cn;const un={class:"container py-4"},mn={class:"edit-profile-container"},pn={class:"row justify-content-center"},fn={class:"col-lg-8"},vn={class:"card shadow-sm"},gn={class:"card-body"},kn={class:"mb-3 text-center"},bn={key:0,class:"bg-primary text-white rounded-circle w-100 h-100 d-flex align-items-center justify-content-center"},hn={class:"mb-3 text-center"},yn={class:"mb-3"},Ln={class:"mb-3"},wn={class:"mb-3"},_n={class:"card mt-4"},Cn={class:"card-body"},En={class:"mb-3"},Pn={class:"mb-3"},Rn={class:"mb-3"},Fn={key:0,class:"alert alert-danger mt-3"},Un={key:1,class:"alert alert-success mt-3"},xn={class:"d-flex justify-content-between mt-4"},In=["disabled"],Wn={key:0,class:"spinner-border spinner-border-sm me-2"};function Xn(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",un,[(0,r.Lk)("div",mn,[(0,r.Lk)("div",pn,[(0,r.Lk)("div",fn,[(0,r.Lk)("div",vn,[t[25]||(t[25]=(0,r.Lk)("div",{class:"card-header bg-white"},[(0,r.Lk)("h4",{class:"mb-0"},"Edit Profile")],-1)),(0,r.Lk)("div",gn,[(0,r.Lk)("form",{onSubmit:t[10]||(t[10]=(0,a.D$)(((...e)=>l.updateProfile&&l.updateProfile(...e)),["prevent"]))},[(0,r.Lk)("div",kn,[(0,r.Lk)("input",{type:"file",ref:"fileInput",class:"d-none",id:"profilePicture",accept:"image/*",onChange:t[0]||(t[0]=(...e)=>l.handleProfilePictureChange&&l.handleProfilePictureChange(...e))},null,544),(0,r.Lk)("div",{class:"profile-avatar mx-auto mb-3 position-relative",style:(0,c.Tr)(l.avatarStyle),onClick:t[1]||(t[1]=(...e)=>l.triggerFileUpload&&l.triggerFileUpload(...e))},[l.previewUrl||l.currentUser.profile_picture?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("div",bn,(0,c.v_)(l.userInitial),1)),t[11]||(t[11]=(0,r.Lk)("div",{class:"avatar-overlay position-absolute"},[(0,r.Lk)("i",{class:"fas fa-camera"})],-1))],4),t[12]||(t[12]=(0,r.Lk)("p",{class:"text-muted small"},"Click to change profile picture",-1))]),(0,r.Lk)("div",hn,[(0,r.Lk)("input",{type:"file",ref:"backgroundFileInput",class:"d-none",id:"backgroundImage",accept:"image/*",onChange:t[2]||(t[2]=(...e)=>l.handleBackgroundImageChange&&l.handleBackgroundImageChange(...e))},null,544),(0,r.Lk)("div",{class:"background-image-preview position-relative",style:(0,c.Tr)(l.backgroundImageStyle),onClick:t[3]||(t[3]=(...e)=>l.triggerBackgroundFileUpload&&l.triggerBackgroundFileUpload(...e))},t[13]||(t[13]=[(0,r.Lk)("div",{class:"background-overlay position-absolute"},[(0,r.Lk)("i",{class:"fas fa-camera"}),(0,r.Lk)("span",null,"Change Background")],-1)]),4),t[14]||(t[14]=(0,r.Lk)("p",{class:"text-muted small"},"Click to change background image",-1))]),(0,r.Lk)("div",yn,[t[15]||(t[15]=(0,r.Lk)("label",{for:"username",class:"form-label"},"Username",-1)),(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",id:"username","onUpdate:modelValue":t[4]||(t[4]=e=>l.form.username=e),readonly:""},null,512),[[a.Jo,l.form.username]]),t[16]||(t[16]=(0,r.Lk)("small",{class:"form-text text-muted"}," Username cannot be changed ",-1))]),(0,r.Lk)("div",Ln,[t[17]||(t[17]=(0,r.Lk)("label",{for:"email",class:"form-label"},"Email",-1)),(0,r.bo)((0,r.Lk)("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":t[5]||(t[5]=e=>l.form.email=e),required:""},null,512),[[a.Jo,l.form.email]])]),(0,r.Lk)("div",wn,[t[18]||(t[18]=(0,r.Lk)("label",{for:"phone_number",class:"form-label"},"Phone Number",-1)),(0,r.bo)((0,r.Lk)("input",{type:"tel",class:"form-control",id:"phone_number","onUpdate:modelValue":t[6]||(t[6]=e=>l.form.phone_number=e),required:""},null,512),[[a.Jo,l.form.phone_number]])]),(0,r.Lk)("div",_n,[t[22]||(t[22]=(0,r.Lk)("div",{class:"card-header"},[(0,r.Lk)("h5",{class:"mb-0"},"Change Password")],-1)),(0,r.Lk)("div",Cn,[(0,r.Lk)("div",En,[t[19]||(t[19]=(0,r.Lk)("label",{for:"current_password",class:"form-label"},"Current Password",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"current_password","onUpdate:modelValue":t[7]||(t[7]=e=>l.passwordForm.current_password=e),placeholder:"Enter current password to change password"},null,512),[[a.Jo,l.passwordForm.current_password]])]),(0,r.Lk)("div",Pn,[t[20]||(t[20]=(0,r.Lk)("label",{for:"new_password",class:"form-label"},"New Password",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"new_password","onUpdate:modelValue":t[8]||(t[8]=e=>l.passwordForm.new_password=e),placeholder:"Leave blank if not changing password"},null,512),[[a.Jo,l.passwordForm.new_password]])]),(0,r.Lk)("div",Rn,[t[21]||(t[21]=(0,r.Lk)("label",{for:"confirm_new_password",class:"form-label"},"Confirm New Password",-1)),(0,r.bo)((0,r.Lk)("input",{type:"password",class:"form-control",id:"confirm_new_password","onUpdate:modelValue":t[9]||(t[9]=e=>l.passwordForm.confirm_new_password=e),placeholder:"Confirm new password"},null,512),[[a.Jo,l.passwordForm.confirm_new_password]])])])]),l.error?((0,r.uX)(),(0,r.CE)("div",Fn,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),l.successMessage?((0,r.uX)(),(0,r.CE)("div",Un,(0,c.v_)(l.successMessage),1)):(0,r.Q3)("",!0),(0,r.Lk)("div",xn,[(0,r.bF)(i,{to:`/profile/${l.currentUser.username}`,class:"btn btn-outline-secondary"},{default:(0,r.k6)((()=>t[23]||(t[23]=[(0,r.eW)(" Cancel ")]))),_:1},8,["to"]),(0,r.Lk)("button",{type:"submit",class:"btn btn-primary",disabled:l.loading},[l.loading?((0,r.uX)(),(0,r.CE)("span",Wn)):(0,r.Q3)("",!0),t[24]||(t[24]=(0,r.eW)(" Save Changes "))],8,In)])],32)])])])])])])}var Dn={name:"EditProfile",setup(){const e=(0,i.Pj)(),t=(0,L.rd)(),s=(0,y.KR)(null),a=(0,y.KR)(null),l=(0,y.KR)(null),o=(0,y.KR)(null),n=(0,y.KR)(null),c=(0,y.KR)(null),d=(0,r.EW)((()=>e.getters["auth/currentUser"]||{})),u=(0,r.EW)((()=>d.value.username?.charAt(0).toUpperCase()||"")),m=(0,r.EW)((()=>{let e=n.value;return!e&&d.value.background_image&&(e=d.value.background_image),{backgroundImage:e?`url(${e})`:"none",backgroundSize:"cover",backgroundPosition:"center",height:"200px",width:"100%",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:e?"transparent":"#f8f9fa"}})),p=(0,r.EW)((()=>{let e=a.value;return!e&&d.value.profile_picture&&(e=d.value.profile_picture),{backgroundImage:e?`url(${e})`:"none",backgroundSize:"cover",backgroundPosition:"center",width:"120px",height:"120px",borderRadius:"50%",cursor:"pointer",position:"relative"}})),f=(0,y.KR)({username:"",email:"",phone_number:""}),v=(0,y.KR)({current_password:"",new_password:"",confirm_new_password:""}),g=(0,y.KR)(!1),k=(0,y.KR)(null),b=(0,y.KR)(null);(0,r.sV)((()=>{f.value={username:d.value.username,email:d.value.email,phone_number:d.value.phone_number||""}}));const h=()=>{s.value.click()},w=()=>{o.value.click()},_=async e=>{const t=e.target.files[0];if(!t)return;if(t.size>5242880)return void(k.value="Profile picture must be less than 5MB");const s=["image/jpeg","image/png","image/gif","image/webp"];if(!s.includes(t.type))return void(k.value="Please select a valid image file (JPEG, PNG, GIF, or WEBP)");const r=new FileReader;r.onload=e=>{a.value=e.target.result},r.readAsDataURL(t),l.value=t,k.value=null,b.value='Profile picture selected. Click "Save Changes" to update.'},C=async e=>{const t=e.target.files[0];if(!t)return;if(t.size>10485760)return void(k.value="Background image must be less than 10MB");const s=["image/jpeg","image/png","image/gif","image/webp"];if(!s.includes(t.type))return void(k.value="Please select a valid image file (JPEG, PNG, GIF, or WEBP)");const a=new FileReader;a.onload=e=>{n.value=e.target.result},a.readAsDataURL(t),c.value=t,k.value=null,b.value='Background image selected. Click "Save Changes" to update.'},E=async()=>{if(k.value=null,b.value=null,v.value.new_password===v.value.confirm_new_password){if(v.value.new_password){const e=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;if(!e.test(v.value.new_password))return void(k.value="New password must be at least 8 characters with uppercase, lowercase, numbers, and special characters");if(!v.value.current_password)return void(k.value="Current password is required to set a new password")}g.value=!0;try{if(l.value)try{await e.dispatch("users/uploadProfilePicture",l.value),l.value=null}catch(s){return k.value="Failed to upload profile picture. Please try again.",void(g.value=!1)}if(c.value)try{await e.dispatch("users/uploadBackgroundImage",c.value),c.value=null}catch(s){return k.value="Failed to upload background image. Please try again.",void(g.value=!1)}const a={email:f.value.email,phone_number:parseInt(f.value.phone_number,10)||0};v.value.new_password&&v.value.current_password&&(a.current_password=v.value.current_password,a.new_password=v.value.new_password);try{await e.dispatch("users/updateUser",a),b.value="Profile updated successfully!",v.value={current_password:"",new_password:"",confirm_new_password:""},setTimeout((()=>{t.push(`/profile/${d.value.username}`)}),1500)}catch(s){k.value=s.response?.data?.detail||"Failed to update profile information"}}finally{g.value=!1}}else k.value="New passwords do not match"};return{form:f,passwordForm:v,loading:g,error:k,successMessage:b,userInitial:u,currentUser:d,fileInput:s,previewUrl:a,avatarStyle:p,triggerFileUpload:h,handleProfilePictureChange:_,updateProfile:E,backgroundFileInput:o,backgroundPreviewUrl:n,backgroundImageStyle:m,triggerBackgroundFileUpload:w,handleBackgroundImageChange:C}}};const An=(0,_.A)(Dn,[["render",Xn],["__scopeId","data-v-334e4343"]]);var Sn=An;const $n={class:"search-view container"},Kn={class:"row"},Vn={class:"col-md-3 d-none d-md-block"},Tn={class:"card mb-4"},qn={class:"card-body"},Bn={class:"list-group list-group-flush"},Qn={class:"col-md-9"},jn={class:"d-md-none mb-4"},On={class:"btn-group w-100"},Nn={class:"card"},Mn={class:"card-body"},zn={key:0},Jn={key:1},Gn={key:2};function Hn(e,t,s,a,l,o){const n=(0,r.g2)("SearchUsers");return(0,r.uX)(),(0,r.CE)("div",$n,[(0,r.Lk)("div",Kn,[(0,r.Lk)("div",Vn,[(0,r.Lk)("div",Tn,[t[9]||(t[9]=(0,r.Lk)("div",{class:"card-header bg-white"},[(0,r.Lk)("h5",{class:"mb-0"},"Search Options")],-1)),(0,r.Lk)("div",qn,[(0,r.Lk)("div",Bn,[(0,r.Lk)("button",{class:(0,c.C4)(["list-group-item list-group-item-action",{active:"users"===a.activeTab}]),onClick:t[0]||(t[0]=e=>a.setActiveTab("users"))},t[6]||(t[6]=[(0,r.Lk)("i",{class:"fas fa-users me-2"},null,-1),(0,r.eW)(" Users ")]),2),(0,r.Lk)("button",{class:(0,c.C4)(["list-group-item list-group-item-action",{active:"posts"===a.activeTab}]),onClick:t[1]||(t[1]=e=>a.setActiveTab("posts"))},t[7]||(t[7]=[(0,r.Lk)("i",{class:"fas fa-file-alt me-2"},null,-1),(0,r.eW)(" Posts ")]),2),(0,r.Lk)("button",{class:(0,c.C4)(["list-group-item list-group-item-action",{active:"reels"===a.activeTab}]),onClick:t[2]||(t[2]=e=>a.setActiveTab("reels"))},t[8]||(t[8]=[(0,r.Lk)("i",{class:"fas fa-film me-2"},null,-1),(0,r.eW)(" Reels ")]),2)])])])]),(0,r.Lk)("div",Qn,[(0,r.Lk)("div",jn,[(0,r.Lk)("div",On,[(0,r.Lk)("button",{class:(0,c.C4)(["btn btn-outline-primary",{active:"users"===a.activeTab}]),onClick:t[3]||(t[3]=e=>a.setActiveTab("users"))},t[10]||(t[10]=[(0,r.Lk)("i",{class:"fas fa-users me-1"},null,-1),(0,r.eW)(" Users ")]),2),(0,r.Lk)("button",{class:(0,c.C4)(["btn btn-outline-primary",{active:"posts"===a.activeTab}]),onClick:t[4]||(t[4]=e=>a.setActiveTab("posts"))},t[11]||(t[11]=[(0,r.Lk)("i",{class:"fas fa-file-alt me-1"},null,-1),(0,r.eW)(" Posts ")]),2),(0,r.Lk)("button",{class:(0,c.C4)(["btn btn-outline-primary",{active:"reels"===a.activeTab}]),onClick:t[5]||(t[5]=e=>a.setActiveTab("reels"))},t[12]||(t[12]=[(0,r.Lk)("i",{class:"fas fa-film me-1"},null,-1),(0,r.eW)(" Reels ")]),2)])]),(0,r.Lk)("div",Nn,[(0,r.Lk)("div",Mn,["users"===a.activeTab?((0,r.uX)(),(0,r.CE)("div",zn,[(0,r.bF)(n)])):"posts"===a.activeTab?((0,r.uX)(),(0,r.CE)("div",Jn,t[13]||(t[13]=[(0,r.Lk)("div",{class:"text-center py-5"},[(0,r.Lk)("i",{class:"fas fa-file-alt fa-3x text-muted mb-3"}),(0,r.Lk)("h4",null,"Post Search"),(0,r.Lk)("p",{class:"text-muted"},"This feature will be coming soon!")],-1)]))):"reels"===a.activeTab?((0,r.uX)(),(0,r.CE)("div",Gn,t[14]||(t[14]=[(0,r.Lk)("div",{class:"text-center py-5"},[(0,r.Lk)("i",{class:"fas fa-film fa-3x text-muted mb-3"}),(0,r.Lk)("h4",null,"Reels Search"),(0,r.Lk)("p",{class:"text-muted"},"This feature will be coming soon!")],-1)]))):(0,r.Q3)("",!0)])])])])])}const Yn={class:"search-users-container"},Zn={class:"mb-4"},ei={class:"input-group"},ti=["disabled"],si={key:0,class:"fas fa-spinner fa-spin"},ai={key:1,class:"fas fa-search"},ri={key:0,class:"alert alert-danger"},li={key:1},oi={key:0,class:"text-center my-4"},ni={key:1,class:"alert alert-info"},ii={key:2},ci={class:"mb-3"},di={class:"list-group"},ui={class:"d-flex align-items-center"},mi={class:"user-avatar bg-primary text-white me-3"},pi={class:"flex-grow-1"},fi={key:0,class:"text-muted mb-0 small"},vi=["onClick","disabled"],gi={key:0,class:"spinner-border spinner-border-sm"},ki={key:1},bi=["onClick","disabled"],hi={key:0,class:"spinner-border spinner-border-sm"},yi={key:1};function Li(e,t,s,l,o,n){const i=(0,r.g2)("router-link");return(0,r.uX)(),(0,r.CE)("div",Yn,[t[5]||(t[5]=(0,r.Lk)("h3",{class:"mb-4"},"User Search",-1)),(0,r.Lk)("div",Zn,[(0,r.Lk)("div",ei,[(0,r.bo)((0,r.Lk)("input",{type:"text",class:"form-control",placeholder:"Search for users...","onUpdate:modelValue":t[0]||(t[0]=e=>l.searchQuery=e),onKeyup:t[1]||(t[1]=(0,a.jR)(((...e)=>l.searchUsers&&l.searchUsers(...e)),["enter"]))},null,544),[[a.Jo,l.searchQuery]]),(0,r.Lk)("button",{class:"btn btn-primary",type:"button",onClick:t[2]||(t[2]=(...e)=>l.searchUsers&&l.searchUsers(...e)),disabled:l.loading},[l.loading?((0,r.uX)(),(0,r.CE)("i",si)):((0,r.uX)(),(0,r.CE)("i",ai))],8,ti)])]),l.error?((0,r.uX)(),(0,r.CE)("div",ri,(0,c.v_)(l.error),1)):(0,r.Q3)("",!0),l.hasSearched?((0,r.uX)(),(0,r.CE)("div",li,[l.loading?((0,r.uX)(),(0,r.CE)("div",oi,t[3]||(t[3]=[(0,r.Lk)("div",{class:"spinner-border text-primary",role:"status"},[(0,r.Lk)("span",{class:"visually-hidden"},"Loading...")],-1),(0,r.Lk)("p",{class:"mt-2"},"Searching users...",-1)]))):0===l.users.length?((0,r.uX)(),(0,r.CE)("div",ni,[t[4]||(t[4]=(0,r.Lk)("i",{class:"fas fa-user-slash me-2"},null,-1)),(0,r.eW)(' No users found matching "'+(0,c.v_)(l.lastSearchQuery)+'". ',1)])):((0,r.uX)(),(0,r.CE)("div",ii,[(0,r.Lk)("h5",ci,'Results for "'+(0,c.v_)(l.lastSearchQuery)+'"',1),(0,r.Lk)("div",di,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(l.users,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"list-group-item user-item"},[(0,r.Lk)("div",ui,[(0,r.Lk)("div",mi,(0,c.v_)(l.getUserInitial(e.username)),1),(0,r.Lk)("div",pi,[(0,r.bF)(i,{to:`/profile/${e.username}`,class:"fw-bold text-decoration-none stretched-link"},{default:(0,r.k6)((()=>[(0,r.eW)((0,c.v_)(e.username),1)])),_:2},1032,["to"]),e.email?((0,r.uX)(),(0,r.CE)("p",fi,(0,c.v_)(e.email),1)):(0,r.Q3)("",!0)]),(0,r.Lk)("div",null,[l.isCurrentUser(e.id)||l.isFollowing(e.id)?(0,r.Q3)("",!0):((0,r.uX)(),(0,r.CE)("button",{key:0,class:"btn btn-sm btn-primary follow-btn",onClick:(0,a.D$)((t=>l.followUser(e.id)),["stop"]),disabled:l.followingInProgress.includes(e.id)},[l.followingInProgress.includes(e.id)?((0,r.uX)(),(0,r.CE)("span",gi)):((0,r.uX)(),(0,r.CE)("span",ki,"Follow"))],8,vi)),!l.isCurrentUser(e.id)&&l.isFollowing(e.id)?((0,r.uX)(),(0,r.CE)("button",{key:1,class:"btn btn-sm btn-outline-primary follow-btn",onClick:(0,a.D$)((t=>l.unfollowUser(e.id)),["stop"]),disabled:l.followingInProgress.includes(e.id)},[l.followingInProgress.includes(e.id)?((0,r.uX)(),(0,r.CE)("span",hi)):((0,r.uX)(),(0,r.CE)("span",yi,"Unfollow"))],8,bi)):(0,r.Q3)("",!0)])])])))),128))])]))])):(0,r.Q3)("",!0)])}var wi={name:"SearchUsers",setup(){const e=(0,i.Pj)(),t=(0,y.KR)(""),s=(0,y.KR)(""),a=(0,y.KR)(!1),l=(0,y.KR)(!1),o=(0,y.KR)(""),n=(0,y.KR)([]),c=(0,r.EW)((()=>e.getters["auth/currentUser"]||{})),d=(0,r.EW)((()=>e.getters["users/following"]||[])),u=(0,r.EW)((()=>e.getters["users/allUsers"]||[])),m=(0,y.KR)([]),p=e=>c.value.id===e,f=e=>d.value.some((t=>t.id===e)),v=e=>e?.charAt(0).toUpperCase()||"",g=async()=>{if(t.value.trim()){l.value=!0,o.value="",a.value=!0,s.value=t.value.trim();try{0===u.value.length&&await e.dispatch("users/fetchUsers");const t=s.value.toLowerCase();m.value=u.value.filter((e=>e.username.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)))}catch(r){o.value="Failed to search users. Please try again.",console.error("User search error:",r)}finally{l.value=!1}}},k=async t=>{if(!n.value.includes(t)){n.value.push(t);try{await e.dispatch("users/followUser",t)}catch(s){o.value="Failed to follow user. Please try again."}finally{n.value=n.value.filter((e=>e!==t))}}},b=async t=>{if(!n.value.includes(t)){n.value.push(t);try{await e.dispatch("users/unfollowUser",t)}catch(s){o.value="Failed to unfollow user. Please try again."}finally{n.value=n.value.filter((e=>e!==t))}}};return{searchQuery:t,lastSearchQuery:s,hasSearched:a,loading:l,error:o,users:m,followingInProgress:n,isCurrentUser:p,isFollowing:f,getUserInitial:v,searchUsers:g,followUser:k,unfollowUser:b}}};const _i=(0,_.A)(wi,[["render",Li],["__scopeId","data-v-195eb800"]]);var Ci=_i,Ei={name:"SearchView",components:{SearchUsers:Ci},setup(){const e=(0,L.lq)(),t=(0,y.KR)("users"),s=e=>{t.value=e};return(0,r.sV)((()=>{e.query.tab&&["users","posts","reels"].includes(e.query.tab)&&(t.value=e.query.tab)})),{activeTab:t,setActiveTab:s}}};const Pi=(0,_.A)(Ei,[["render",Hn],["__scopeId","data-v-e78e5fea"]]);var Ri=Pi;const Fi=[{path:"/",name:"Home",component:Pt,meta:{requiresAuth:!0}},{path:"/search",name:"Search",component:Ri,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:Nt,meta:{guestOnly:!0}},{path:"/register",name:"Register",component:gs,meta:{guestOnly:!0}},{path:"/profile/:username",name:"Profile",component:oa,meta:{requiresAuth:!0}},{path:"/edit-profile",name:"EditProfile",component:Sn,meta:{requiresAuth:!0}},{path:"/posts/:id",name:"PostDetail",component:Oa,meta:{requiresAuth:!0}},{path:"/create-post",name:"CreatePost",component:cr,meta:{requiresAuth:!0}},{path:"/edit-post/:id",name:"EditPost",component:Ur,meta:{requiresAuth:!0}},{path:"/reels",name:"Reels",component:hl,meta:{requiresAuth:!0}},{path:"/reels/:id",name:"ReelDetail",component:Lo,meta:{requiresAuth:!0}},{path:"/create-reel",name:"CreateReel",component:sn,meta:{requiresAuth:!0}},{path:"/edit-reel/:id",name:"EditReel",component:dn,meta:{requiresAuth:!0}},{path:"/:pathMatch(.*)*",name:"NotFound",component:Ar}],Ui=(0,L.aE)({history:(0,L.LA)("/social_media_platform-frontend/"),routes:Fi});Ui.beforeEach(((e,t,s)=>{const a=ye.getters["auth/isAuthenticated"];e.matched.some((e=>e.meta.requiresAuth))?a?s():s({name:"Login",query:{redirect:e.fullPath.replace("/social_media_platform-frontend","")}}):e.matched.some((e=>e.meta.guestOnly))&&a?s({name:"Home"}):s()}));var xi=Ui;s(323);const Ii=(0,a.Ef)(A);Ii.use(ye),Ii.use(xi),Ii.config.errorHandler=(e,t,s)=>{console.error("Vue Error:",e),console.error("Info:",s)},Ii.mount("#app")}},t={};function s(a){var r=t[a];if(void 0!==r)return r.exports;var l=t[a]={exports:{}};return e[a].call(l.exports,l,l.exports,s),l.exports}s.m=e,function(){var e=[];s.O=function(t,a,r,l){if(!a){var o=1/0;for(d=0;d<e.length;d++){a=e[d][0],r=e[d][1],l=e[d][2];for(var n=!0,i=0;i<a.length;i++)(!1&l||o>=l)&&Object.keys(s.O).every((function(e){return s.O[e](a[i])}))?a.splice(i--,1):(n=!1,l<o&&(o=l));if(n){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[a,r,l]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var r,l,o=a[0],n=a[1],i=a[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(i)var d=i(s)}for(t&&t(a);c<o.length;c++)l=o[c],s.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return s.O(d)},a=self["webpackChunksocial_media_frontend"]=self["webpackChunksocial_media_frontend"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(2462)}));a=s.O(a)})();
//# sourceMappingURL=app.08ed2dd0.js.map